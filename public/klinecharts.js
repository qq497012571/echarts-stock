/**
 * @license
 * KLineChart v9.1.1
 * Copyright (c) 2019 lihu.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).klinecharts={})}(this,(function(t){"use strict";function e(t,i){if(r(t)||r(i))for(var o in i)if(Object.prototype.hasOwnProperty.call(i,o)){var a=t[o],l=i[o];r(l)&&r(a)&&!n(l)&&!n(a)?e(a,l):s(i[o])&&(t[o]=i[o])}}function i(t){if(!r(t)||!n(t))return t;var e;for(var o in e=n(t)?[]:{},t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=t[o];r(a)?e[o]=i(a):e[o]=a}return e}function n(t){return"[object Array]"===Object.prototype.toString.call(t)}function o(t){return"function"==typeof t}function r(t){return"object"==typeof t}function a(t){return"number"==typeof t&&!isNaN(t)}function s(t){return null!=t}function l(t){return"string"==typeof t}var c,u,h,d,p,v,g,f,m,y=/\\(\\)?/g,_=RegExp("[^.[\\]]+|\\[(?:([^\"'][^[]*)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))","g");function x(t,e,i){if(s(t)){var n=[];e.replace(_,(function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=t;return s(e[1])?o=e[2].replace(y,"$1"):s(e[0])&&(o=e[0].trim()),n.push(o),""}));for(var o=t,r=0,a=n.length;s(o)&&r<a;)o=null==o?void 0:o[n[r++]];return s(o)?o:null!=i?i:"--"}return null!=i?i:"--"}function S(t,e,i){var n=t.format(new Date(e)).split(", "),o=n[0].split("/"),r=n[1].split(":"),a={YYYY:o[2],MM:o[0],DD:o[1],HH:"24"===r[0]?"00":r[0],mm:r[1],ss:r[2]};return i.replace(/YYYY|MM|DD|HH|mm|ss/g,(function(t){return a[t]}))}function C(t,e){var i=+t;return a(i)?i.toFixed(null!=e?e:2):"".concat(i)}function b(t){var e=+t;return a(e)?t>1e9?"".concat(+(e/1e9).toFixed(3),"B"):t>1e6?"".concat(+(e/1e6).toFixed(3),"M"):t>1e3?"".concat(+(e/1e3).toFixed(3),"K"):"".concat(t):"--"}t.LineType=void 0,(c=t.LineType||(t.LineType={})).Dashed="dashed",c.Solid="solid",t.PolygonType=void 0,(u=t.PolygonType||(t.PolygonType={})).Stroke="stroke",u.Fill="fill",u.StrokeFill="stroke_fill",t.TooltipShowRule=void 0,(h=t.TooltipShowRule||(t.TooltipShowRule={})).Always="always",h.FollowCross="follow_cross",h.None="none",t.TooltipShowType=void 0,(d=t.TooltipShowType||(t.TooltipShowType={})).Standard="standard",d.Rect="rect",t.TooltipIconPosition=void 0,(p=t.TooltipIconPosition||(t.TooltipIconPosition={})).Left="left",p.Middle="middle",p.Right="right",t.CandleType=void 0,(v=t.CandleType||(t.CandleType={})).CandleSolid="candle_solid",v.CandleStroke="candle_stroke",v.CandleUpStroke="candle_up_stroke",v.CandleDownStroke="candle_down_stroke",v.Ohlc="ohlc",v.Area="area",t.YAxisPosition=void 0,(g=t.YAxisPosition||(t.YAxisPosition={})).Left="left",g.Right="right",t.YAxisType=void 0,(f=t.YAxisType||(t.YAxisType={})).Normal="normal",f.Percentage="percentage",f.Log="log",t.FormatDateType=void 0,(m=t.FormatDateType||(t.FormatDateType={}))[m.Tooltip=0]="Tooltip",m[m.Crosshair=1]="Crosshair",m[m.XAxis=2]="XAxis";var w=function(t,e){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},w(t,e)};function T(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}w(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var I,E=function(){return E=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},E.apply(this,arguments)};function P(t,e,i,n){return new(i||(i=Promise))((function(o,r){function a(t){try{l(n.next(t))}catch(t){r(t)}}function s(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))}function D(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(i=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{i=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function M(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function k(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,o,r=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=r.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return a}function A(t,e,i){if(i||2===arguments.length)for(var n,o=0,r=e.length;o<r;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}t.ActionType=void 0,(I=t.ActionType||(t.ActionType={})).OnZoom="onZoom",I.OnScroll="onScroll",I.OnVisibleRangeChange="onVisibleRangeChange",I.OnTooltipIconClick="onTooltipIconClick",I.OnCrosshairChange="onCrosshairChange",I.OnCandleBarClick="onCandleBarClick",I.OnPaneDrag="onPaneDrag";var F,L=function(){function t(){this._callbacks=[]}return t.prototype.subscribe=function(t){var e;(null!==(e=this._callbacks.indexOf(t))&&void 0!==e?e:-1)<0&&this._callbacks.push(t)},t.prototype.unsubscribe=function(t){var e;if(void 0!==t){var i=null!==(e=this._callbacks.indexOf(t))&&void 0!==e?e:-1;i>-1&&this._callbacks.splice(i,1)}else this._callbacks=[]},t.prototype.execute=function(t){this._callbacks.forEach((function(e){e(t)}))},t.prototype.isEmpty=function(){return 0===this._callbacks.length},t}(),R=new(function(){function t(){this._baseId=1}return t.prototype.next=function(t){var e=(new Date).getTime();return e===this._prevIdTimestamp?++this._baseId:this._baseId=1,this._prevIdTimestamp=e,"".concat(null!=t?t:"").concat(e,"_").concat(this._baseId)},t}());function B(t){return R.next(t)}function O(t,e){var i,n=document.createElement(t),o=null!=e?e:{};for(var r in o)n.style[r]=null!==(i=o[r])&&void 0!==i?i:"";return n}function V(t){var e,i,n;return null!==(n=null===(i=null===(e=t.ownerDocument)||void 0===e?void 0:e.defaultView)||void 0===i?void 0:i.devicePixelRatio)&&void 0!==n?n:2}function N(t,e,i){return"".concat(null!=e?e:"normal"," ").concat(null!=t?t:12,"px ").concat(null!=i?i:"Helvetica Neue")}function W(t,e,i,n){if(void 0===F){var o=document.createElement("canvas"),r=V(o);(F=o.getContext("2d")).scale(r,r)}return F.font=N(e,i,n),Math.round(F.measureText(t).width)}function z(t,e,i){var n=0,o=0;for(o=t.length-1;n!==o;){var r=Math.floor((o+n)/2),a=o-n,s=t[r][e];if(i===t[n][e])return n;if(i===t[o][e])return o;if(i===s)return r;if(i>s?n=r:o=r,a<=2)break}return n}function Y(t,e){return null==e&&(e=10),e=Math.min(Math.max(0,e),20),+(+t).toFixed(e)}function H(t,e,i){var n=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];return t.forEach((function(t){var o,r;n[0]=Math.max(null!==(o=t[e])&&void 0!==o?o:t,n[0]),n[1]=Math.min(null!==(r=t[i])&&void 0!==r?r:t,n[1])})),n}function X(t){return Math.log(t)/Math.log(10)}function j(t){return Math.pow(10,t)}var G,U=1,q=50,Z=function(){function e(t){this._dateTimeFormat=this._buildDateTimeFormat(),this._zoomEnabled=!0,this._scrollEnabled=!0,this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalBarSpace=0,this._barSpace=6,this._offsetRightDistance=50,this._startScrollOffsetRightBarCount=0,this._minVisibleBarCount={left:2,right:2},this._visibleRange={from:0,to:0},this._chartStore=t,this._gapBarSpace=this._calcGapBarSpace(),this._offsetRightBarCount=this._offsetRightDistance/this._barSpace}return e.prototype._calcGapBarSpace=function(){var t=Math.floor(.82*this._barSpace),e=Math.floor(this._barSpace),i=Math.min(t,e-1);return Math.max(1,i)},e.prototype.adjustVisibleRange=function(){var e,i=this._chartStore.getDataList(),n=i.length,o=this._totalBarSpace/this._barSpace,r=o-Math.min(this._minVisibleBarCount.left,n);this._offsetRightBarCount>r&&(this._offsetRightBarCount=r);var a=-n+Math.min(this._minVisibleBarCount.right,n);this._offsetRightBarCount<a&&(this._offsetRightBarCount=a);var s=Math.round(this._offsetRightBarCount+n+.5);s>n&&(s=n);var l=Math.round(s-o)-1;if(l<0&&(l=0),this._visibleRange={from:l,to:s},this._chartStore.getActionStore().execute(t.ActionType.OnVisibleRangeChange,{from:l,to:s}),this._chartStore.adjustVisibleDataList(),0===l&&this._more&&!this._loading&&null!==this._loadMoreCallback){this._loading=!0;var c=i[0];this._loadMoreCallback(null!==(e=null==c?void 0:c.timestamp)&&void 0!==e?e:null)}},e.prototype.setMore=function(t){return this._more=t,this},e.prototype.setLoading=function(t){return this._loading=t,this},e.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},e.prototype._buildDateTimeFormat=function(t){var e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};void 0!==t&&(e.timeZone=t);var i=null;try{i=new Intl.DateTimeFormat("en",e)}catch(t){}return i},e.prototype.setTimezone=function(t){var e=this._buildDateTimeFormat(t);null!==e&&(this._dateTimeFormat=e)},e.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},e.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:this._gapBarSpace/2}},e.prototype.setBarSpace=function(t,e){t<U||t>q||this._barSpace===t||(this._barSpace=t,this._gapBarSpace=this._calcGapBarSpace(),null==e||e(),this.adjustVisibleRange(),this._chartStore.getCrosshairStore().recalculate(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0))},e.prototype.setTotalBarSpace=function(t){return this._totalBarSpace!==t&&(this._totalBarSpace=t,this.adjustVisibleRange(),this._chartStore.getCrosshairStore().recalculate(!0)),this},e.prototype.setOffsetRightDistance=function(t,e){return this._offsetRightDistance=t,this._offsetRightBarCount=t/this._barSpace,null!=e&&e&&(this.adjustVisibleRange(),this._chartStore.getCrosshairStore().recalculate(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)),this},e.prototype.resetOffsetRightDistance=function(){this.setOffsetRightDistance(this._offsetRightDistance)},e.prototype.getOffsetRightDistance=function(){return this._offsetRightDistance},e.prototype.getOffsetRightBarCount=function(){return this._offsetRightBarCount},e.prototype.setOffsetRightBarCount=function(t){return this._offsetRightBarCount=t,this},e.prototype.setLeftMinVisibleBarCount=function(t){return this._minVisibleBarCount.left=t,this},e.prototype.setRightMinVisibleBarCount=function(t){return this._minVisibleBarCount.right=t,this},e.prototype.getVisibleRange=function(){return this._visibleRange},e.prototype.startScroll=function(){this._startScrollOffsetRightBarCount=this._offsetRightBarCount},e.prototype.scroll=function(e){if(this._scrollEnabled){var i=e/this._barSpace;this._chartStore.getActionStore().execute(t.ActionType.OnScroll),this._offsetRightBarCount=this._startScrollOffsetRightBarCount-i,this.adjustVisibleRange(),this._chartStore.getCrosshairStore().recalculate(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)}},e.prototype.getDataByDataIndex=function(t){var e;return null!==(e=this._chartStore.getDataList()[t])&&void 0!==e?e:null},e.prototype.coordinateToFloatIndex=function(t){var e=this._chartStore.getDataList().length,i=(this._totalBarSpace-t)/this._barSpace,n=e+this._offsetRightBarCount-i;return Math.round(1e6*n)/1e6},e.prototype.dataIndexToTimestamp=function(t){var e,i=this.getDataByDataIndex(t);return null!==(e=null==i?void 0:i.timestamp)&&void 0!==e?e:null},e.prototype.timestampToDataIndex=function(t){var e=this._chartStore.getDataList();return 0===e.length?0:z(e,"timestamp",t)},e.prototype.dataIndexToCoordinate=function(t){var e=this._chartStore.getDataList().length+this._offsetRightBarCount-t;return this._totalBarSpace-(e-.5)*this._barSpace},e.prototype.coordinateToDataIndex=function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1},e.prototype.zoom=function(e,i){var n=this;if(this._zoomEnabled){if(void 0===(null==i?void 0:i.x)){var o=this._chartStore.getCrosshairStore().get();i={x:void 0!==(null==o?void 0:o.x)?o.x:this._totalBarSpace/2}}this._chartStore.getActionStore().execute(t.ActionType.OnZoom);var r=this.coordinateToFloatIndex(i.x),a=this._barSpace+e*(this._barSpace/10);this.setBarSpace(a,(function(){n._offsetRightBarCount+=r-n.coordinateToFloatIndex(null==i?void 0:i.x)}))}},e.prototype.setZoomEnabled=function(t){return this._zoomEnabled=t,this},e.prototype.getZoomEnabled=function(){return this._zoomEnabled},e.prototype.setScrollEnabled=function(t){return this._scrollEnabled=t,this},e.prototype.getScrollEnabled=function(){return this._scrollEnabled},e.prototype.setLoadMoreCallback=function(t){return this._loadMoreCallback=t,this},e.prototype.clear=function(){this._more=!0,this._loading=!0,this._visibleRange={from:0,to:0}},e}();function K(t,e,i,n,o){var r,a,l,c=e.result,u=e.figures,h=e.styles,d=x(h,"circles",n.circles),p=d.length,v=x(h,"bars",n.bars),g=v.length,f=x(h,"lines",n.lines),m=f.length,y=0,_=0,S=0,C=0;u.forEach((function(u){var h,x,b,w;switch(u.type){case"circle":r=d[y%p],a=r.style,l=r.noChangeColor,C=y,y++;break;case"bar":r=v[_%g],a=r.style,l=r.noChangeColor,C=_,_++;break;case"line":r=f[S%m],a=r.style,l=r.color,C=S,S++}if(s(r)){var T={prev:{kLineData:t[i-1],indicatorData:c[i-1]},current:{kLineData:t[i],indicatorData:c[i]},next:{kLineData:t[i+1],indicatorData:c[i+1]}},I=null!==(x=null===(h=u.styles)||void 0===h?void 0:h.call(u,T,e,n))&&void 0!==x?x:{style:a,color:l};o(u,{style:null!==(b=I.style)&&void 0!==b?b:a,color:null!==(w=I.color)&&void 0!==w?w:l},r,C)}}))}t.IndicatorSeries=void 0,(G=t.IndicatorSeries||(t.IndicatorSeries={})).Normal="normal",G.Price="price",G.Volume="volume";var $=function(){function e(e){this.result=[],this._precisionFlag=!1;var i=e.name,n=e.shortName,o=e.series,r=e.calcParams,a=e.figures,s=e.precision,l=e.shouldOhlc,c=e.shouldFormatBigNumber,u=e.visible,h=e.minValue,d=e.maxValue,p=e.styles,v=e.extendData,g=e.regenerateFigures,f=e.createTooltipDataSource,m=e.draw;this.name=i,this.shortName=null!=n?n:i,this.series=null!=o?o:t.IndicatorSeries.Normal,this.precision=null!=s?s:4,this.calcParams=null!=r?r:[],this.figures=null!=a?a:[],this.shouldOhlc=null!=l&&l,this.shouldFormatBigNumber=null!=c&&c,this.visible=null==u||u,this.minValue=null!=h?h:null,this.maxValue=null!=d?d:null,this.styles=null!=p?p:null,this.extendData=v,this.regenerateFigures=null!=g?g:null,this.createTooltipDataSource=null!=f?f:null,this.draw=null!=m?m:null}return e.prototype.setShortName=function(t){return this.shortName!==t&&(this.shortName=t,!0)},e.prototype.setSeries=function(t){return this.series!==t&&(this.series=t,!0)},e.prototype.setPrecision=function(t,e){var i=null!=e&&e,n=Math.floor(t);return!(!(n!==this.precision&&t>=0)||i&&(!i||this._precisionFlag))&&(this.precision=n,i||(this._precisionFlag=!0),!0)},e.prototype.setCalcParams=function(t){var e,i;return this.calcParams=t,this.figures=null!==(i=null===(e=this.regenerateFigures)||void 0===e?void 0:e.call(this,t))&&void 0!==i?i:this.figures,!0},e.prototype.setShouldOhlc=function(t){return this.shouldOhlc!==t&&(this.shouldOhlc=t,!0)},e.prototype.setShouldFormatBigNumber=function(t){return this.shouldFormatBigNumber!==t&&(this.shouldFormatBigNumber=t,!0)},e.prototype.setVisible=function(t){return this.visible!==t&&(this.visible=t,!0)},e.prototype.setStyles=function(t){return this.styles!==t&&(this.styles=t,!0)},e.prototype.setExtendData=function(t){return this.extendData!==t&&(this.extendData=t,!0)},e.prototype.setFigures=function(t){return this.figures!==t&&(this.figures=t,!0)},e.prototype.setMinValue=function(t){return this.minValue!==t&&(this.minValue=t,!0)},e.prototype.setMaxValue=function(t){return this.maxValue!==t&&(this.maxValue=t,!0)},e.prototype.setRegenerateFigures=function(t){return this.regenerateFigures!==t&&(this.regenerateFigures=t,!0)},e.prototype.setCreateTooltipDataSource=function(t){return this.createTooltipDataSource!==t&&(this.createTooltipDataSource=t,!0)},e.prototype.setDraw=function(t){return this.draw!==t&&(this.draw=t,!0)},e.prototype.calcIndicator=function(t){return P(this,void 0,void 0,(function(){var e;return D(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.calc(t,this)];case 1:return e=i.sent(),this.result=e,[2,!0];case 2:return i.sent(),[2,!1];case 3:return[2]}}))}))},e.extend=function(t){return function(e){function i(){return e.call(this,t)||this}return T(i,e),i.prototype.calc=function(e,i){return t.calc(e,i)},i}(e)},e}(),J={name:"AVP",shortName:"AVP",series:t.IndicatorSeries.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(t){var e=0,i=0;return t.map((function(t){var n,o,r={},a=null!==(n=null==t?void 0:t.turnover)&&void 0!==n?n:0,s=null!==(o=null==t?void 0:t.volume)&&void 0!==o?o:0;return e+=a,0!==(i+=s)&&(r.avp=e/i),r}))}},Q={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(t,e,i){var n,o,r,a,s=t.prev,l=t.current,c=null!==(o=null===(n=s.indicatorData)||void 0===n?void 0:n.ao)&&void 0!==o?o:Number.MIN_SAFE_INTEGER,u=null!==(a=null===(r=l.indicatorData)||void 0===r?void 0:r.ao)&&void 0!==a?a:Number.MIN_SAFE_INTEGER;return{color:u>c?x(e.styles,"bars[0].upColor",i.bars[0].upColor):x(e.styles,"bars[0].downColor",i.bars[0].downColor),style:u>c?"stroke":"fill"}}}],calc:function(t,e){var i=e.calcParams,n=Math.max(i[0],i[1]),o=0,r=0,a=0,s=0;return t.map((function(e,l){var c={},u=(e.low+e.high)/2;if(o+=u,r+=u,l>=i[0]-1){a=o/i[0];var h=t[l-(i[0]-1)];o-=(h.low+h.high)/2}if(l>=i[1]-1){s=r/i[1];h=t[l-(i[1]-1)];r-=(h.low+h.high)/2}return l>=n-1&&(c.ao=a-s),c}))}};var tt={name:"BOLL",shortName:"BOLL",series:t.IndicatorSeries.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=i[0]-1,o=0;return t.map((function(e,r){var a=e.close,s={};if(o+=a,r>=n){s.mid=o/i[0];var l=function(t,e){var i=t.length,n=0;return t.forEach((function(t){var i=t.close-e;n+=i*i})),n=Math.abs(n),Math.sqrt(n/i)}(t.slice(r-n,r+1),s.mid);s.up=s.mid+i[1]*l,s.dn=s.mid-i[1]*l,o-=t[r-n].close}return s}))}},et={name:"BBI",shortName:"BBI",series:t.IndicatorSeries.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.max.apply(Math,A([],k(i),!1)),o=[],r=[];return t.map((function(e,a){var s={},l=e.close;if(i.forEach((function(e,i){var n;o[i]=(null!==(n=o[i])&&void 0!==n?n:0)+l,a>=e-1&&(r[i]=o[i]/e,o[i]-=t[a-(e-1)].close)})),a>=n-1){var c=0;r.forEach((function(t){c+=t})),s.bbi=c/4}return s}))}},it={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=i[0]-1,o=0,r=[];return t.map((function(e,a){var s={},l=(e.high+e.low+e.close)/3;if(o+=l,r.push(l),a>=n){var c=o/i[0],u=r.slice(a-n,a+1),h=0;u.forEach((function(t){h+=Math.abs(t-c)}));var d=h/i[0];s.cci=0!==d?(l-c)/d/.015:0;var p=(t[a-n].high+t[a-n].low+t[a-n].close)/3;o-=p}return s}))}},nt={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.ceil(i[1]/2.5+1),o=Math.ceil(i[2]/2.5+1),r=Math.ceil(i[3]/2.5+1),a=Math.ceil(i[4]/2.5+1),s=0,l=[],c=0,u=[],h=0,d=[],p=0,v=[],g=[];return t.forEach((function(e,f){var m,y,_,x,S,C={},b=null!==(m=t[f-1])&&void 0!==m?m:e,w=(b.high+b.close+b.low+b.open)/4,T=Math.max(0,e.high-w),I=Math.max(0,w-e.low);f>=i[0]-1&&(C.cr=0!==I?T/I*100:0,s+=C.cr,c+=C.cr,h+=C.cr,p+=C.cr,f>=i[0]+i[1]-2&&(l.push(s/i[1]),f>=i[0]+i[1]+n-3&&(C.ma1=l[l.length-1-n]),s-=null!==(y=g[f-(i[1]-1)].cr)&&void 0!==y?y:0),f>=i[0]+i[2]-2&&(u.push(c/i[2]),f>=i[0]+i[2]+o-3&&(C.ma2=u[u.length-1-o]),c-=null!==(_=g[f-(i[2]-1)].cr)&&void 0!==_?_:0),f>=i[0]+i[3]-2&&(d.push(h/i[3]),f>=i[0]+i[3]+r-3&&(C.ma3=d[d.length-1-r]),h-=null!==(x=g[f-(i[3]-1)].cr)&&void 0!==x?x:0),f>=i[0]+i[4]-2&&(v.push(p/i[4]),f>=i[0]+i[4]+a-3&&(C.ma4=v[v.length-1-a]),p-=null!==(S=g[f-(i[4]-1)].cr)&&void 0!==S?S:0)),g.push(C)})),g}},ot={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.max(i[0],i[1]),o=0,r=0,a=0,s=[];return t.forEach((function(e,l){var c,u={},h=e.close;o+=h,r+=h;var d=0,p=0;if(l>=i[0]-1&&(d=o/i[0],o-=t[l-(i[0]-1)].close),l>=i[1]-1&&(p=r/i[1],r-=t[l-(i[1]-1)].close),l>=n-1){var v=d-p;u.dma=v,a+=v,l>=n+i[2]-2&&(u.ama=a/i[2],a-=null!==(c=s[l-(i[2]-1)].dma)&&void 0!==c?c:0)}s.push(u)})),s}},rt={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=0,a=0,s=0,l=0,c=0,u=0,h=[];return t.forEach((function(e,d){var p,v,g={},f=null!==(p=t[d-1])&&void 0!==p?p:e,m=f.close,y=e.high,_=e.low,x=y-_,S=Math.abs(y-m),C=Math.abs(m-_),b=y-f.high,w=f.low-_,T=Math.max(Math.max(x,S),C),I=b>0&&b>w?b:0,E=w>0&&w>b?w:0;if(n+=T,o+=I,r+=E,d>=i[0]-1){d>i[0]-1?(a=a-a/i[0]+T,s=s-s/i[0]+I,l=l-l/i[0]+E):(a=n,s=o,l=r);var P=0,D=0;0!==a&&(P=100*s/a,D=100*l/a),g.pdi=P,g.mdi=D;var M=0;D+P!==0&&(M=Math.abs(D-P)/(D+P)*100),c+=M,d>=2*i[0]-2&&(u=d>2*i[0]-2?(u*(i[0]-1)+M)/i[0]:c/i[0],g.adx=u,d>=2*i[0]+i[1]-3&&(g.adxr=((null!==(v=h[d-(i[1]-1)].adx)&&void 0!==v?v:0)+u)/2))}h.push(g)})),h}},at={name:"EMA",shortName:"EMA",series:t.IndicatorSeries.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"ema".concat(e+1),title:"EMA".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=0,r=[];return t.map((function(t,e){var a={},s=t.close;return o+=s,i.forEach((function(t,i){e>=t-1&&(r[i]=e>t-1?(2*s+(t-1)*r[i])/(t+1):o/t,a[n[i].key]=r[i])})),a}))}},st={name:"MA",shortName:"MA",series:t.IndicatorSeries.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[];return t.map((function(e,r){var a={},s=e.close;return i.forEach((function(e,i){var l;o[i]=(null!==(l=o[i])&&void 0!==l?l:0)+s,r>=e-1&&(a[n[i].key]=o[i]/e,o[i]-=t[r-(e-1)].close)})),a}))}},lt={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(t,e,i){var n,o,r,a,s=t.prev,l=t.current,c=null!==(o=null===(n=s.indicatorData)||void 0===n?void 0:n.macd)&&void 0!==o?o:Number.MIN_SAFE_INTEGER,u=null!==(a=null===(r=l.indicatorData)||void 0===r?void 0:r.macd)&&void 0!==a?a:Number.MIN_SAFE_INTEGER;return{style:c<u?"stroke":"fill",color:u>0?x(e.styles,"bars[0].upColor",i.bars[0].upColor):u<0?x(e.styles,"bars[0].downColor",i.bars[0].downColor):x(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}}}],calc:function(t,e){var i,n,o=e.calcParams,r=0,a=0,s=0,l=0,c=Math.max(o[0],o[1]);return t.map((function(t,e){var u={},h=t.close;return r+=h,e>=o[0]-1&&(i=e>o[0]-1?(2*h+(o[0]-1)*i)/(o[0]+1):r/o[0]),e>=o[1]-1&&(n=e>o[1]-1?(2*h+(o[1]-1)*n)/(o[1]+1):r/o[1]),e>=c-1&&(a=i-n,u.dif=a,s+=a,e>=c+o[2]-2&&(l=e>c+o[2]-2?(2*a+l*(o[2]-1))/(o[2]+1):s/o[2],u.macd=2*(a-l),u.dea=l)),u}))}},ct={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){var i=e+1;return{key:"rsi".concat(i),title:"RSI".concat(i,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[],r=[];return t.map((function(e,a){var s,l={},c=(null!==(s=t[a-1])&&void 0!==s?s:e).close,u=e.close-c;return i.forEach((function(e,i){var s,c,h;if(u>0?o[i]=(null!==(s=o[i])&&void 0!==s?s:0)+u:r[i]=(null!==(c=r[i])&&void 0!==c?c:0)+Math.abs(u),a>=e-1){0!==r[i]?l[n[i].key]=100-100/(1+o[i]/r[i]):l[n[i].key]=0;var d=t[a-(e-1)],p=null!==(h=t[a-e])&&void 0!==h?h:d,v=d.close-p.close;v>0?o[i]-=v:r[i]-=Math.abs(v)}})),l}))}},ut={name:"SMA",shortName:"SMA",series:t.IndicatorSeries.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(t,e){var i=e.calcParams,n=0,o=0;return t.map((function(t,e){var r={},a=t.close;return n+=a,e>=i[0]-1&&(o=e>i[0]-1?(a*i[1]+o*(i[0]-i[1]+1))/(i[0]+1):n/i[0],r.sma=o),r}))}},ht={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=[];return t.forEach((function(e,o){var r,a,s,l,c={},u=e.close;if(o>=i[0]-1){var h=H(t.slice(o-(i[0]-1),o+1),"high","low"),d=h[0],p=h[1],v=d-p,g=(u-p)/(0===v?1:v)*100;c.k=((i[1]-1)*(null!==(a=null===(r=n[o-1])||void 0===r?void 0:r.k)&&void 0!==a?a:50)+g)/i[1],c.d=((i[2]-1)*(null!==(l=null===(s=n[o-1])||void 0===s?void 0:s.d)&&void 0!==l?l:50)+c.k)/i[2],c.j=3*c.k-2*c.d}n.push(c)})),n}},dt={name:"SAR",shortName:"SAR",series:t.IndicatorSeries.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(t,e,i){var n,o,r=t.current,a=null!==(o=null===(n=r.indicatorData)||void 0===n?void 0:n.sar)&&void 0!==o?o:Number.MIN_SAFE_INTEGER,s=r.kLineData;return{color:a<((null==s?void 0:s.high)+(null==s?void 0:s.low))/2?x(e.styles,"circles[0].upColor",i.circles[0].upColor):x(e.styles,"circles[0].downColor",i.circles[0].downColor)}}}],calc:function(t,e){var i=e.calcParams,n=i[0]/100,o=i[1]/100,r=i[2]/100,a=n,s=-100,l=!1,c=0;return t.map((function(e,i){var u=c,h=e.high,d=e.low;if(l){(-100===s||s<h)&&(s=h,a=Math.min(a+o,r)),c=u+a*(s-u);var p=Math.min(t[Math.max(1,i)-1].low,d);c>e.low?(c=s,a=n,s=-100,l=!l):c>p&&(c=p)}else{(-100===s||s>d)&&(s=d,a=Math.min(a+o,r)),c=u+a*(s-u);var v=Math.max(t[Math.max(1,i)-1].high,h);c<e.high?(c=s,a=0,s=-100,l=!l):c<v&&(c=v)}return{sar:c}}))}},pt={name:"VOL",shortName:"VOL",series:t.IndicatorSeries.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(t,e,i){var n=t.current.kLineData;return{color:n.close>n.open?x(e.styles,"bars[0].upColor",i.bars[0].upColor):n.close<n.open?x(e.styles,"bars[0].downColor",i.bars[0].downColor):x(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}}}],regenerateFigures:function(t){var e=t.map((function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}}));return e.push({key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(t,e,i){var n=t.current.kLineData;return{color:n.close>n.open?x(e.styles,"bars[0].upColor",i.bars[0].upColor):n.close<n.open?x(e.styles,"bars[0].downColor",i.bars[0].downColor):x(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}}}),e},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[];return t.map((function(e,r){var a,s=null!==(a=e.volume)&&void 0!==a?a:0,l={volume:s};return i.forEach((function(e,i){var a,c;o[i]=(null!==(a=o[i])&&void 0!==a?a:0)+s,r>=e-1&&(l[n[i].key]=o[i]/e,o[i]-=null!==(c=t[r-(e-1)].volume)&&void 0!==c?c:0)})),l}))}},vt={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures;return t.map((function(e,o){var r={},a=e.close;return i.forEach((function(e,i){var s=e-1;if(o>=s){var l=H(t.slice(o-s,o+1),"high","low"),c=l[0],u=c-l[1];r[n[i].key]=0===u?0:(a-c)/u*100}})),r}))}},gt={},ft=[J,Q,{name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"bias".concat(e+1),title:"BIAS".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[];return t.map((function(e,r){var a={},s=e.close;return i.forEach((function(e,l){var c;if(o[l]=(null!==(c=o[l])&&void 0!==c?c:0)+s,r>=e-1){var u=o[l]/i[l];a[n[l].key]=(s-u)/u*100,o[l]-=t[r-(e-1)].close}})),a}))}},tt,{name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=0,a=0;return t.map((function(e,s){var l,c,u={},h=e.high,d=e.low,p=e.open,v=(null!==(l=t[s-1])&&void 0!==l?l:e).close;if(r+=h-p,a+=p-d,n+=h-v,o+=v-d,s>=i[0]-1){u.ar=0!==a?r/a*100:0,u.br=0!==o?n/o*100:0;var g=t[s-(i[0]-1)],f=g.high,m=g.low,y=g.open,_=(null!==(c=t[s-i[0]])&&void 0!==c?c:t[s-(i[0]-1)]).close;n-=f-_,o-=_-m,r-=f-y,a-=y-m}return u}))}},et,it,nt,ot,rt,{name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=[],a=[];return t.forEach((function(e,s){var l,c,u,h={},d=null!==(l=t[s-1])&&void 0!==l?l:e,p=e.high,v=e.low,g=null!==(c=e.turnover)&&void 0!==c?c:0,f=(p+v)/2,m=(d.high+d.low)/2,y=0;0!==g&&(y=(f-m)*(p-v)/g),r.push(y),n+=y,s>=i[0]-1&&(h.emv=n,n-=r[s-(i[0]-1)],o+=h.emv,s>=i[0]+i[1]-2&&(h.maEmv=o/i[1],o-=null!==(u=a[s-(i[1]-1)].emv)&&void 0!==u?u:0)),a.push(h)})),a}},at,{name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=[];return t.forEach((function(e,r){var a,s={};if(r>=i[0]){var l=e.close,c=t[r-i[0]].close;s.mtm=l-c,n+=s.mtm,r>=i[0]+i[1]-1&&(s.maMtm=n/i[1],n-=null!==(a=o[r-(i[1]-1)].mtm)&&void 0!==a?a:0)}o.push(s)})),o}},st,lt,{name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=[];return t.forEach((function(e,a){var s,l,c,u,h=null!==(s=t[a-1])&&void 0!==s?s:e;e.close<h.close?o-=null!==(l=e.volume)&&void 0!==l?l:0:e.close>h.close&&(o+=null!==(c=e.volume)&&void 0!==c?c:0);var d={obv:o};n+=o,a>=i[0]-1&&(d.maObv=n/i[0],n-=null!==(u=r[a-(i[0]-1)].obv)&&void 0!==u?u:0),r.push(d)})),r}},{name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(t){var e=0;return t.map((function(i,n){var o,r,a={},s=i.close,l=null!==(o=i.volume)&&void 0!==o?o:1,c=(null!==(r=t[n-1])&&void 0!==r?r:i).close,u=0,h=c*l;return 0!==h&&(u=(s-c)/h),e+=u,a.pvt=e,a}))}},{name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=[],a=[];return t.forEach((function(e,s){var l,c,u={},h=(null!==(l=t[s-1])&&void 0!==l?l:e).close,d=e.close-h>0?1:0;r.push(d),n+=d,s>=i[0]-1&&(u.psy=n/i[0]*100,o+=u.psy,s>=i[0]+i[1]-2&&(u.maPsy=o/i[1],o-=null!==(c=a[s-(i[1]-1)].psy)&&void 0!==c?c:0),n-=r[s-(i[0]-1)]),a.push(u)})),a}},{name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=[],o=0;return t.forEach((function(e,r){var a,s,l={};if(r>=i[0]-1){var c=e.close,u=(null!==(a=t[r-i[0]])&&void 0!==a?a:t[r-(i[0]-1)]).close;l.roc=0!==u?(c-u)/u*100:0,o+=l.roc,r>=i[0]-1+i[1]-1&&(l.maRoc=o/i[1],o-=null!==(s=n[r-(i[1]-1)].roc)&&void 0!==s?s:0)}n.push(l)})),n}},ct,ut,ht,dt,{name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(t,e){var i,n,o,r=e.calcParams,a=0,s=0,l=0,c=0,u=[];return t.forEach((function(t,e){var h,d={},p=t.close;if(a+=p,e>=r[0]-1&&(i=e>r[0]-1?(2*p+(r[0]-1)*i)/(r[0]+1):a/r[0],s+=i,e>=2*r[0]-2&&(n=e>2*r[0]-2?(2*i+(r[0]-1)*n)/(r[0]+1):s/r[0],l+=n,e>=3*r[0]-3))){var v=void 0,g=0;e>3*r[0]-3?g=((v=(2*n+(r[0]-1)*o)/(r[0]+1))-o)/o*100:v=l/r[0],o=v,d.trix=g,c+=g,e>=3*r[0]+r[1]-4&&(d.maTrix=c/r[1],c-=null!==(h=u[e-(r[1]-1)].trix)&&void 0!==h?h:0)}u.push(d)})),u}},pt,{name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=0,a=0,s=[];return t.forEach((function(e,l){var c,u,h,d,p,v={},g=e.close,f=(null!==(c=t[l-1])&&void 0!==c?c:e).close,m=null!==(u=e.volume)&&void 0!==u?u:0;if(g>f?n+=m:g<f?o+=m:r+=m,l>=i[0]-1){var y=r/2;v.vr=o+y===0?0:(n+y)/(o+y)*100,a+=v.vr,l>=i[0]+i[1]-2&&(v.maVr=a/i[1],a-=null!==(h=s[l-(i[1]-1)].vr)&&void 0!==h?h:0);var _=t[l-(i[0]-1)],x=null!==(d=t[l-i[0]])&&void 0!==d?d:_,S=_.close,C=null!==(p=_.volume)&&void 0!==p?p:0;S>x.close?n-=C:S<x.close?o-=C:r-=C}s.push(v)})),s}},vt];function mt(t){var e;return null!==(e=gt[t])&&void 0!==e?e:null}ft.forEach((function(t){gt[t.name]=$.extend(t)}));var yt,_t=function(){function e(t){this._instances=new Map,this._chartStore=t}return e.prototype._overrideInstance=function(t,e){var i=e.shortName,n=e.series,o=e.calcParams,r=e.precision,a=e.figures,s=e.minValue,l=e.maxValue,c=e.shouldOhlc,u=e.shouldFormatBigNumber,h=e.visible,d=e.styles,p=e.extendData,v=e.regenerateFigures,g=e.createTooltipDataSource,f=e.draw,m=e.calc,y=!1;void 0!==i&&t.setShortName(i)&&(y=!0),void 0!==n&&t.setSeries(n)&&(y=!0);var _=!1;return void 0!==o&&t.setCalcParams(o)&&(y=!0,_=!0),void 0!==a&&t.setFigures(a)&&(y=!0,_=!0),void 0!==s&&t.setMinValue(s)&&(y=!0),void 0!==l&&t.setMinValue(l)&&(y=!0),void 0!==r&&t.setPrecision(r)&&(y=!0),void 0!==c&&t.setShouldOhlc(c)&&(y=!0),void 0!==u&&t.setShouldFormatBigNumber(u)&&(y=!0),void 0!==h&&t.setVisible(h)&&(y=!0),void 0!==d&&t.setStyles(d)&&(y=!0),void 0!==p&&t.setExtendData(p)&&(y=!0,_=!0),void 0!==v&&t.setRegenerateFigures(v)&&(y=!0),void 0!==g&&t.setCreateTooltipDataSource(g)&&(y=!0),void 0!==f&&t.setDraw(f)&&(y=!0),void 0!==m&&(t.calc=m,_=!0),[y,_]},e.prototype.addInstance=function(t,e,i){var n;return P(this,void 0,void 0,(function(){var o,r,a,s;return D(this,(function(l){switch(l.label){case 0:return o=t.name,r=this._instances.get(e),null!==(n=null==r?void 0:r.has(o))&&void 0!==n&&n?[4,Promise.reject(new Error("Duplicate indicators."))]:[3,2];case 1:case 3:return[2,l.sent()];case 2:return void 0===r&&(r=new Map,this._instances.set(e,r)),a=mt(o),s=new a,this._overrideInstance(s,t),i||r.clear(),r.set(o,s),[4,s.calcIndicator(this._chartStore.getDataList())]}}))}))},e.prototype.getInstances=function(t){var e;return null!==(e=this._instances.get(t))&&void 0!==e?e:new Map},e.prototype.removeInstance=function(t,e){var i=!1,n=this._instances.get(t);return void 0!==n&&(void 0!==e?n.has(e)&&(n.delete(e),i=!0):(n.clear(),i=!0),0===n.size&&this._instances.delete(t)),i},e.prototype.hasInstances=function(t){return this._instances.has(t)},e.prototype.calcInstance=function(t,e){var i;return P(this,void 0,void 0,(function(){var n,o,r,a=this;return D(this,(function(s){switch(s.label){case 0:return n=[],void 0!==t?void 0!==e?(o=this._instances.get(e),null!==(i=null==o?void 0:o.has(t))&&void 0!==i&&i&&(r=null==o?void 0:o.get(t),n.push(r.calcIndicator(this._chartStore.getDataList())))):this._instances.forEach((function(e){if(e.has(t)){var i=null==e?void 0:e.get(t);n.push(i.calcIndicator(a._chartStore.getDataList()))}})):this._instances.forEach((function(t){t.forEach((function(t){n.push(t.calcIndicator(a._chartStore.getDataList()))}))})),[4,Promise.all(n)];case 1:return[2,s.sent().includes(!0)]}}))}))},e.prototype.getInstanceByPaneId=function(t,e){var i;if(void 0!==t){var n=this._instances.get(t);return void 0!==e?null!==(i=null==n?void 0:n.get(e))&&void 0!==i?i:null:null!=n?n:null}return this._instances},e.prototype.setSeriesPrecision=function(e){this._instances.forEach((function(i){i.forEach((function(i){i.series===t.IndicatorSeries.Price&&i.setPrecision(e.price,!0),i.series===t.IndicatorSeries.Volume&&i.setPrecision(e.volume,!0)}))}))},e.prototype.override=function(t,e){return P(this,void 0,void 0,(function(){var i,n,o,r,a,s,l=this;return D(this,(function(c){switch(c.label){case 0:return i=t.name,n=new Map,null!==e?void 0!==(o=this._instances.get(e))&&n.set(e,o):n=this._instances,r=!1,a=[],n.forEach((function(e){var n=e.get(i);if(void 0!==n){var o=l._overrideInstance(n,t);o[1]?a.push(n.calcIndicator(l._chartStore.getDataList())):o[0]&&(r=!0)}})),[4,Promise.all(a)];case 1:return s=c.sent(),[2,[r,s.includes(!0)]]}}))}))},e}(),xt=function(){function t(t){this._crosshair={},this._chartStore=t}return t.prototype.set=function(t,e){var i,n,o=this._chartStore.getDataList(),r=null!=t?t:{},a=o[n=void 0!==r.x?(i=this._chartStore.getTimeScaleStore().coordinateToDataIndex(r.x))<0?0:i>o.length-1?o.length-1:i:i=o.length-1],s=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(i),l=this._crosshair.x,c=this._crosshair.y,u=this._crosshair.paneId;return this._crosshair=E(E({},r),{realX:s,kLineData:a,realDataIndex:i,dataIndex:n}),l===r.x&&c===r.y&&u===r.paneId||(null!==a&&this._chartStore.getChart().crosshairChange(this._crosshair),null!=e&&e||this._chartStore.getChart().updatePane(1)),this},t.prototype.recalculate=function(t){this.set(this._crosshair,t)},t.prototype.get=function(){return this._crosshair},t}(),St=function(){function t(){this._activeIconInfo=null}return t.prototype.setActiveIconInfo=function(t){this._activeIconInfo=null!=t?t:null},t.prototype.getActiveIconInfo=function(){return this._activeIconInfo},t}();t.OverlayMode=void 0,(yt=t.OverlayMode||(t.OverlayMode={})).Normal="normal",yt.WeakMagnet="weak_magnet",yt.StrongMagnet="strong_magnet";var Ct=function(){function e(e){this.currentStep=1,this.points=[],this._prevPressedPoint=null,this._prevPressedPoints=[];var i=e.mode,n=e.extendData,o=e.styles,r=e.name,a=e.totalStep,s=e.lock,l=e.visible,c=e.needDefaultPointFigure,u=e.needDefaultXAxisFigure,h=e.needDefaultYAxisFigure,d=e.createPointFigures,p=e.createXAxisFigures,v=e.createYAxisFigures,g=e.performEventPressedMove,f=e.performEventMoveForDrawing,m=e.onDrawStart,y=e.onDrawing,_=e.onDrawEnd,x=e.onClick,S=e.onRightClick,C=e.onPressedMoveStart,b=e.onPressedMoving,w=e.onPressedMoveEnd,T=e.onMouseEnter,I=e.onMouseLeave,E=e.onRemoved,P=e.onSelected,D=e.onDeselected;this.name=r,this.totalStep=void 0===a||a<2?1:a,this.lock=null!=s&&s,this.visible=null==l||l,this.needDefaultPointFigure=null!=c&&c,this.needDefaultXAxisFigure=null!=u&&u,this.needDefaultYAxisFigure=null!=h&&h,this.mode=null!=i?i:t.OverlayMode.Normal,this.extendData=n,this.styles=null!=o?o:null,this.createPointFigures=null!=d?d:null,this.createXAxisFigures=null!=p?p:null,this.createYAxisFigures=null!=v?v:null,this.performEventPressedMove=null!=g?g:null,this.performEventMoveForDrawing=null!=f?f:null,this.onDrawStart=null!=m?m:null,this.onDrawing=null!=y?y:null,this.onDrawEnd=null!=_?_:null,this.onClick=null!=x?x:null,this.onRightClick=null!=S?S:null,this.onPressedMoveStart=null!=C?C:null,this.onPressedMoving=null!=b?b:null,this.onPressedMoveEnd=null!=w?w:null,this.onMouseEnter=null!=T?T:null,this.onMouseLeave=null!=I?I:null,this.onRemoved=null!=E?E:null,this.onSelected=null!=P?P:null,this.onDeselected=null!=D?D:null}return e.prototype.setId=function(t){return void 0===this.id&&(this.id=t,!0)},e.prototype.setGroupId=function(t){return void 0===this.groupId&&(this.groupId=t,!0)},e.prototype.setExtendData=function(t){return t!==this.extendData&&(this.extendData=t,!0)},e.prototype.setStyles=function(t){return t!==this.styles&&(this.styles=t,!0)},e.prototype.setPoints=function(t){if(t.length>0){var e=void 0;if(this.points=A([],k(t),!1),t.length>=this.totalStep-1?(this.currentStep=-1,e=this.totalStep-1):(this.currentStep=t.length+1,e=t.length),null!==this.performEventMoveForDrawing)for(var i=0;i<e;i++)this.performEventMoveForDrawing({currentStep:i+2,mode:this.mode,points:this.points,performPointIndex:i,performPoint:this.points[i]});return-1===this.currentStep&&null!==this.performEventPressedMove&&this.performEventPressedMove({currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}),!0}return!1},e.prototype.setLock=function(t){return this.lock!==t&&(this.lock=t,!0)},e.prototype.setVisible=function(t){return this.visible!==t&&(this.visible=t,!0)},e.prototype.setMode=function(t){return t!==this.mode&&(this.mode=t,!0)},e.prototype.setOnDrawStartCallback=function(t){return this.onDrawStart!==t&&(this.onDrawStart=t,!0)},e.prototype.setOnDrawingCallback=function(t){return this.onDrawing!==t&&(this.onDrawing=t,!0)},e.prototype.setOnDrawEndCallback=function(t){return this.onDrawEnd!==t&&(this.onDrawEnd=t,!0)},e.prototype.setOnClickCallback=function(t){return this.onClick!==t&&(this.onClick=t,!0)},e.prototype.setOnRightClickCallback=function(t){return this.onRightClick!==t&&(this.onRightClick=t,!0)},e.prototype.setOnPressedMoveStartCallback=function(t){return this.onPressedMoveStart!==t&&(this.onPressedMoveStart=t,!0)},e.prototype.setOnPressedMovingCallback=function(t){return this.onPressedMoving!==t&&(this.onPressedMoving=t,!0)},e.prototype.setOnPressedMoveEndCallback=function(t){return this.onPressedMoveEnd!==t&&(this.onPressedMoveEnd=t,!0)},e.prototype.setOnMouseEnterCallback=function(t){return this.onMouseEnter!==t&&(this.onMouseEnter=t,!0)},e.prototype.setOnMouseLeaveCallback=function(t){return this.onMouseLeave!==t&&(this.onMouseLeave=t,!0)},e.prototype.setOnRemovedCallback=function(t){return this.onRemoved!==t&&(this.onRemoved=t,!0)},e.prototype.setOnSelectedCallback=function(t){return this.onSelected!==t&&(this.onSelected=t,!0)},e.prototype.setOnDeselectedCallback=function(t){return this.onDeselected!==t&&(this.onDeselected=t,!0)},e.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=-1:this.currentStep++},e.prototype.forceComplete=function(){this.currentStep=-1},e.prototype.isDrawing=function(){return-1!==this.currentStep},e.prototype.isStart=function(){return 1===this.currentStep},e.prototype.eventMoveForDrawing=function(t){var e,i=this.currentStep-1,n={};void 0!==t.timestamp&&(n.timestamp=t.timestamp),void 0!==t.dataIndex&&(n.dataIndex=t.dataIndex),void 0!==t.value&&(n.value=t.value),this.points[i]=n,null===(e=this.performEventMoveForDrawing)||void 0===e||e.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:i,performPoint:n})},e.prototype.eventPressedPointMove=function(t,e){var i;void 0!==t.dataIndex&&(this.points[e].dataIndex=t.dataIndex,this.points[e].timestamp=t.timestamp),void 0!==t.value&&(this.points[e].value=t.value),null===(i=this.performEventPressedMove)||void 0===i||i.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:e,performPoint:this.points[e]})},e.prototype.startPressedMove=function(t){this._prevPressedPoint=E({},t),this._prevPressedPoints=i(this.points)},e.prototype.eventPressedOtherMove=function(t,e){var i,n;null!==this._prevPressedPoint&&(void 0!==t.dataIndex&&void 0!==this._prevPressedPoint.dataIndex&&(i=t.dataIndex-this._prevPressedPoint.dataIndex),void 0!==t.value&&void 0!==this._prevPressedPoint.value&&(n=t.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map((function(t){var o;void 0===t.dataIndex&&void 0!==t.timestamp&&(t.dataIndex=e.timestampToDataIndex(t.timestamp));var r=E({},t);return void 0!==i&&void 0!==t.dataIndex&&(r.dataIndex=t.dataIndex+i,r.timestamp=null!==(o=e.dataIndexToTimestamp(r.dataIndex))&&void 0!==o?o:void 0),void 0!==n&&void 0!==t.value&&(r.value=t.value+n),r})))},e.extend=function(t){return function(e){function i(){return e.call(this,t)||this}return T(i,e),i}(e)},e}();function bt(t,e){return Math.sqrt(Math.pow(t.x+e.x,2)+Math.pow(t.y+e.y,2))}function wt(t){var e=bt(t[0],t[1]),i=e+bt(t[1],t[2]),n=[t[2].x-t[0].x,t[2].y-t[0].y];return[{x:t[1].x-.5*n[0]*e/i,y:t[1].y-.5*n[1]*e/i},{x:t[1].x+.5*n[0]*e/i,y:t[1].y+.5*n[1]*e/i}]}function Tt(t,e){var i=!1,n=e.coordinates;if(n.length>1)for(var o=1;o<n.length;o++){var r=n[o-1],a=n[o];if(r.x===a.x)i=Math.abs(t.x-r.x)<2;else{var s=Pt(r,a),l=It(s,t),c=Math.abs(l-t.y);i=c*c/(s[0]*s[0]+1)<4}if(i)return i}return i}function It(t,e){return null!=t?e.x*t[0]+t[1]:e.y}function Et(t,e,i){return It(Pt(t,e),i)}function Pt(t,e){var i=t.x-e.x;if(0!==i){var n=(t.y-e.y)/i;return[n,t.y-n*t.x]}return null}function Dt(e,i,n){var o=i.coordinates,r=o.length;if(r>1){var a=n.style,s=void 0===a?t.LineType.Solid:a,l=n.smooth,c=n.size,u=void 0===c?1:c,h=n.color,d=void 0===h?"currentColor":h,p=n.dashedValue,v=void 0===p?[2,2]:p;if(e.lineWidth=u,e.strokeStyle=d,s===t.LineType.Dashed?e.setLineDash(v):e.setLineDash([]),e.beginPath(),e.moveTo(o[0].x,o[0].y),null!=l&&l){for(var g=[],f=1;f<r-1;f++)g=g.concat(wt([o[f-1],o[f],o[f+1]]));e.quadraticCurveTo(g[0].x,g[0].y,o[1].x,o[1].y);for(var m=2;m<r-1;m++)e.bezierCurveTo(g[2*(m-2)+1].x,g[2*(m-2)+1].y,g[2*(m-1)].x,g[2*(m-1)].y,o[m].x,o[m].y);e.quadraticCurveTo(g[2*(m-2)+1].x,g[2*(m-2)+1].y,o[m].x,o[m].y)}else for(m=1;m<o.length;m++)e.lineTo(o[m].x,o[m].y);e.stroke(),e.closePath()}}var Mt={name:"line",checkEventOn:Tt,draw:function(t,e,i){Dt(t,e,i)}};function kt(t,e,i){var n=null!=i?i:0,o=[];if(t.length>1)if(t[0].x===t[1].x){var r=e.height;if(o.push({coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:r}]}),t.length>2){o.push({coordinates:[{x:t[2].x,y:0},{x:t[2].x,y:r}]});for(var a=t[0].x-t[2].x,s=0;s<n;s++){var l=a*(s+1);o.push({coordinates:[{x:t[0].x+l,y:0},{x:t[0].x+l,y:r}]})}}}else{var c=e.width,u=Pt(t[0],t[1]),h=u[0],d=u[1];if(o.push({coordinates:[{x:0,y:0*h+d},{x:c,y:c*h+d}]}),t.length>2){var p=t[2].y-h*t[2].x;o.push({coordinates:[{x:0,y:0*h+p},{x:c,y:c*h+p}]});for(a=d-p,s=0;s<n;s++){var v=d+a*(s+1);o.push({coordinates:[{x:0,y:0*h+v},{x:c,y:c*h+v}]})}}}return o}function At(t,e){if(t.length>1){var i=void 0;return i=t[0].x===t[1].x&&t[0].y!==t[1].y?t[0].y<t[1].y?{x:t[0].x,y:e.height}:{x:t[0].x,y:0}:t[0].x>t[1].x?{x:0,y:Et(t[0],t[1],{x:0,y:t[0].y})}:{x:e.width,y:Et(t[0],t[1],{x:e.width,y:t[0].y})},{coordinates:[t[0],i]}}return[]}var Ft={name:"simpleAnnotation",createPointFigures:function(t){var e,i,n=t.overlay,r=t.coordinates;s(n.extendData)&&(i=o(n.extendData)?n.extendData(n):null!==(e=n.extendData)&&void 0!==e?e:"");var a=r[0].x,l=r[0].y-6,c=l-50,u=c-5;return[{type:"line",attrs:{coordinates:[{x:a,y:l},{x:a,y:c}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:a,y:c},{x:a-4,y:u},{x:a+4,y:u}]},ignoreEvent:!0},{type:"rectText",attrs:{x:a,y:u,text:null!=i?i:"",align:"center",baseline:"bottom"},ignoreEvent:!0}]}},Lt={name:"simpleTag",createPointFigures:function(t){var e=t.bounding,i=t.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:i[0].y},{x:e.width,y:i[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(t){var e,i,n,r,a,l=t.overlay,c=t.coordinates,u=t.bounding,h=t.yAxis,d=t.precision;return null!==(e=null==h?void 0:h.isFromZero())&&void 0!==e&&e?(n="left",r=0):(n="right",r=u.width),s(l.extendData)&&(a=o(l.extendData)?l.extendData(l):null!==(i=l.extendData)&&void 0!==i?i:""),s(a)||void 0===l.points[0].value||(a=C(l.points[0].value,d.price)),{type:"rectText",attrs:{x:r,y:c[0].y,text:null!=a?a:"",align:n,baseline:"middle"}}}},Rt={};function Bt(t){var e;return null!==(e=Rt[t])&&void 0!==e?e:null}function Ot(t){var i={width:0,height:0,left:0,right:0,top:0,bottom:0};return void 0!==t&&e(i,t),i}[{name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding,n=t.overlay,o=t.precision,r=n.points;if(e.length>0){var a=[],s=[],l=i.width;if(e.length>1&&void 0!==r[0].value&&void 0!==r[1].value){var c=e[0].y-e[1].y,u=r[0].value-r[1].value;[1,.786,.618,.5,.382,.236,0].forEach((function(t){var i,n=e[1].y+c*t,h=((null!==(i=r[1].value)&&void 0!==i?i:0)+u*t).toFixed(o.price);a.push({coordinates:[{x:0,y:n},{x:l,y:n}]}),s.push({x:0,y:n,text:"".concat(h," (").concat((100*t).toFixed(1),"%)"),baseline:"bottom"})}))}return[{type:"line",attrs:a},{type:"text",isCheckEvent:!1,attrs:s}]}return[]}},{name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding,n={x:0,y:e[0].y};return void 0!==e[1]&&e[0].x<e[1].x&&(n.x=i.width),[{type:"line",attrs:{coordinates:[e[0],n]}}]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].value=n.value)}},{name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=[];return 2===e.length&&i.push({coordinates:e}),[{type:"line",attrs:i}]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].value=n.value)}},{name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return[{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:i.width,y:e[0].y}]}}]}},{name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:kt(t.coordinates,t.bounding)}]}},{name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:kt(t.coordinates,t.bounding,1)}]}},{name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding,n=t.precision,o=t.overlay.points[0].value,r=void 0===o?0:o;return[{type:"line",attrs:{coordinates:[e[0],{x:i.width,y:e[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:e[0].x,y:e[0].y,text:r.toFixed(n.price),baseline:"bottom"}}]}},{name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:At(t.coordinates,t.bounding)}]}},{name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return 2===e.length?[{type:"line",attrs:{coordinates:e}}]:[]}},{name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return 2===e.length?e[0].x===e[1].x?[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:i.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:Et(e[0],e[1],{x:0,y:e[0].y})},{x:i.width,y:Et(e[0],e[1],{x:i.width,y:e[0].y})}]}}]:[]}},{name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;if(2===e.length){var n={x:e[0].x,y:0};return e[0].y<e[1].y&&(n.y=i.height),[{type:"line",attrs:{coordinates:[e[0],n]}}]}return[]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].timestamp=n.timestamp,i[0].dataIndex=n.dataIndex)}},{name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return 2===e.length?[{type:"line",attrs:{coordinates:e}}]:[]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].timestamp=n.timestamp,i[0].dataIndex=n.dataIndex)}},{name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:i.height}]}}]}},Ft,Lt].forEach((function(t){Rt[t.name]=Ct.extend(t)}));var Vt=function(){function t(){this._children=[],this._callbacks=new Map}return t.prototype.registerEvent=function(t,e){return this._callbacks.set(t,e),this},t.prototype.onEvent=function(t,e,i){var n=this._callbacks.get(t);return!(void 0===n||!this.checkEventOn(e))&&n(e,i)},t.prototype.checkEventOn=function(t){var e,i;try{for(var n=M(this._children),o=n.next();!o.done;o=n.next()){if(o.value.checkEventOn(t))return!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}return!1},t.prototype.dispatchEvent=function(t,e,i){var n=this._children.length-1;if(n>-1)for(var o=n;o>-1;o--)if(this._children[o].dispatchEvent(t,e,i))return!0;return this.onEvent(t,e,i)},t.prototype.addChild=function(t){return this._children.push(t),this},t.prototype.clear=function(){this._children=[]},t}(),Nt="main",Wt="xAxis",zt="yAxis",Yt="separator",Ht=function(t){function i(e,i){var n=t.call(this)||this;return n._bounding=Ot(),n._pane=i,n._init(e),n}return T(i,t),i.prototype._init=function(t){if(this._container=O("div",this.getContainerStyle()),this.insertBefore()){var e=t.lastChild;null!==e?t.insertBefore(this._container,e):t.appendChild(this._container)}else t.appendChild(this._container);this.initDom(this._container)},i.prototype.setBounding=function(t){return e(this._bounding,t),this},i.prototype.getContainer=function(){return this._container},i.prototype.getBounding=function(){return this._bounding},i.prototype.getPane=function(){return this._pane},i.prototype.update=function(t){this.updateImp(t,this._container,this._bounding)},i.prototype.insertBefore=function(){return!1},i}(Vt);var Xt=function(e){function i(t,i){var n,o,r,a=e.call(this,t,i)||this;return a._dragFlag=!1,a._dragStartY=0,a._topPaneHeight=0,a._currentPaneHeight=0,a._pressedMouseMoveEvent=(n=a._pressedTouchMouseMoveEvent,o=20,r=0,function(){var t=Date.now();t-r>(null!=o?o:20)&&(n.apply(this,arguments),r=t)}),a.registerEvent("touchStartEvent",a._mouseDownEvent.bind(a)).registerEvent("touchMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("touchEndEvent",a._mouseUpEvent.bind(a)).registerEvent("mouseDownEvent",a._mouseDownEvent.bind(a)).registerEvent("mouseUpEvent",a._mouseUpEvent.bind(a)).registerEvent("pressedMouseMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("mouseEnterEvent",a._mouseEnterEvent.bind(a)).registerEvent("mouseLeaveEvent",a._mouseLeaveEvent.bind(a)),a}return T(i,e),i.prototype.getName=function(){return Yt},i.prototype.checkEventOn=function(){return!0},i.prototype._mouseDownEvent=function(t){var e,i;this._dragFlag=!0,this._dragStartY=t.pageY;var n=this.getPane();return this._topPaneHeight=null!==(i=null===(e=n.getTopPane())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,this._currentPaneHeight=n.getBounding().height,!0},i.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._mouseLeaveEvent()},i.prototype._pressedTouchMouseMoveEvent=function(e){var i=e.pageY-this._dragStartY,n=this.getPane(),o=n.getTopPane(),r=i<0;if(null!==o&&n.getOptions().dragEnabled){var a=void 0,s=void 0,l=void 0,c=void 0;r?(a=o,s=n,l=this._topPaneHeight,c=this._currentPaneHeight):(a=n,s=o,l=this._currentPaneHeight,c=this._topPaneHeight);var u=a.getOptions().minHeight;if(l>u){var h=Math.max(l-Math.abs(i),u),d=l-h;a.setBounding({height:h}),s.setBounding({height:c+d});var p=n.getChart();p.getChartStore().getActionStore().execute(t.ActionType.OnPaneDrag,{paneId:n.getId}),p.adjustPaneViewport(!0,!0,!0,!0,!0)}}return!0},i.prototype._mouseEnterEvent=function(){var t=this.getPane();if(t.getOptions().dragEnabled){var e=t.getChart().getStyles().separator;return this._moveDom.style.background=e.activeBackgroundColor,!0}return!1},i.prototype._mouseLeaveEvent=function(){return!this._dragFlag&&(this._moveDom.style.background="",!0)},i.prototype.getContainerStyle=function(){return{margin:"0",padding:"0",position:"relative",boxSizing:"border-box"}},i.prototype.insertBefore=function(){return!0},i.prototype.initDom=function(t){this._moveDom=O("div",{width:"100%",height:"".concat(7,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"}),t.appendChild(this._moveDom)},i.prototype.updateImp=function(t,e,i){if(4===t||2===t){var n=this.getPane().getChart().getStyles().separator;this._moveDom.style.top="".concat(-Math.floor((7-n.size)/2),"px"),this._moveDom.style.height="".concat(7,"px");var o=n.fill;e.style.backgroundColor=n.color,e.style.height="".concat(n.size,"px"),e.style.marginLeft="".concat(o?0:i.left,"px"),e.style.width=o?"100%":"".concat(i.width,"px")}},i.prototype.getImage=function(){var t=this.getPane().getChart().getStyles().separator,e=this.getContainer().offsetWidth,i=t.size,n=O("canvas",{width:"".concat(e,"px"),height:"".concat(i,"px"),boxSizing:"border-box"}),o=n.getContext("2d"),r=V(n);return n.width=e*r,n.height=i*r,o.scale(r,r),o.fillStyle=t.color,o.fillRect(this.getBounding().left,0,e,i),n},i}(Ht),jt="candle_pane",Gt="indcator_pane_",Ut="xaxis_pane",qt=function(){function t(t,e,i,n,o){this._yAxisWidget=null,this._separatorWidget=null,this._axis=this.createAxisComponent(),this._bounding=Ot(),this._options={minHeight:30,dragEnabled:!0,gap:{top:.2,bottom:.1}},this._chart=e,this._id=i,this._topPane=null!=n?n:null,this._bottomPane=null!=o?o:null,this._init(t)}return t.prototype._init=function(t){this._container=t,this._seriesContiainer=O("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"}),this._separatorWidget=this.createSeparatorWidget(t);var e=t.lastChild;null!==e?t.insertBefore(this._seriesContiainer,e):t.appendChild(this._seriesContiainer),this._mainWidget=this.createMainWidget(this._seriesContiainer),this._yAxisWidget=this.creatYAxisWidget(this._seriesContiainer)},t.prototype.getContainer=function(){return this._seriesContiainer},t.prototype.getId=function(){return this._id},t.prototype.setOptions=function(t){return e(this._options,t),this},t.prototype.getOptions=function(){return this._options},t.prototype.getChart=function(){return this._chart},t.prototype.getAxisComponent=function(){return this._axis},t.prototype.setBounding=function(t,i,n){var o,r,a;e(this._bounding,t);var s=0;if(null!==this._separatorWidget){s=this._chart.getStyles().separator.size;var l=E(E({},t),{height:7});void 0!==t.top&&(l.top=t.top-Math.floor((7-s)/2)),this._separatorWidget.setBounding(l)}var c={};return void 0!==t.height&&(c.height=t.height-s),void 0!==t.top&&(c.top=t.top+s),this._mainWidget.setBounding(c),null===(o=this._yAxisWidget)||void 0===o||o.setBounding(c),void 0!==i&&(this._mainWidget.setBounding(i),null===(r=this._separatorWidget)||void 0===r||r.setBounding(i)),void 0!==n&&(null===(a=this._yAxisWidget)||void 0===a||a.setBounding(n)),this},t.prototype.getTopPane=function(){return this._topPane},t.prototype.setTopPane=function(t){return this._topPane=t,this},t.prototype.getBottomPane=function(){return this._bottomPane},t.prototype.setBottomPane=function(t){return this._bottomPane=t,this},t.prototype.getBounding=function(){return this._bounding},t.prototype.getMainWidget=function(){return this._mainWidget},t.prototype.getYAxisWidget=function(){return this._yAxisWidget},t.prototype.getSeparatorWidget=function(){return this._separatorWidget},t.prototype.update=function(t){var e,i;this._bounding.width!==this._seriesContiainer.offsetWidth&&(this._seriesContiainer.style.width="".concat(this._bounding.width,"px"));var n=this._mainWidget.getBounding().height;n!==this._seriesContiainer.offsetHeight&&(this._seriesContiainer.style.height="".concat(n,"px"));var o=null!=t?t:3;this._mainWidget.update(o),null===(e=this._yAxisWidget)||void 0===e||e.update(o),null===(i=this._separatorWidget)||void 0===i||i.update(o)},t.prototype.getImage=function(t){var e=this._bounding,i=e.width,n=e.height,o=O("canvas",{width:"".concat(i,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),r=o.getContext("2d"),a=V(o);o.width=i*a,o.height=n*a,r.scale(a,a);var s=0;if(null!=this._separatorWidget){var l=this.getChart().getStyles().separator.size;s=l,r.drawImage(this._separatorWidget.getImage(),0,0,i,l)}var c=this._mainWidget.getBounding();if(r.drawImage(this._mainWidget.getImage(t),c.left,s,c.width,c.height),null!==this._yAxisWidget){var u=this._yAxisWidget.getBounding();r.drawImage(this._yAxisWidget.getImage(t),u.left,s,u.width,u.height)}return o},t.prototype.destroy=function(){this._container.removeChild(this._seriesContiainer),null!==this._separatorWidget&&this._container.removeChild(this._separatorWidget.getContainer())},t.prototype.createSeparatorWidget=function(t){return null},t.prototype.creatYAxisWidget=function(t){return null},t}(),Zt=function(){function t(t){this._instances=new Map,this._progressInstanceInfo=null,this._pressedInstanceInfo={paneId:"",instance:null,figureType:0,figureIndex:-1,attrsIndex:-1},this._hoverInstanceInfo={paneId:"",instance:null,figureType:0,figureIndex:-1,attrsIndex:-1},this._clickInstanceInfo={paneId:"",instance:null,figureType:0,figureIndex:-1,attrsIndex:-1},this._chartStore=t}return t.prototype._overrideInstance=function(t,e){var i=e.id,n=e.groupId,o=e.points,r=e.styles,a=e.lock,s=e.visible,l=e.mode,c=e.extendData,u=e.onDrawStart,h=e.onDrawing,d=e.onDrawEnd,p=e.onClick,v=e.onRightClick,g=e.onPressedMoveStart,f=e.onPressedMoving,m=e.onPressedMoveEnd,y=e.onMouseEnter,_=e.onMouseLeave,x=e.onRemoved,S=e.onSelected,C=e.onDeselected,b=!1;return void 0!==i&&t.setId(i),void 0!==n&&t.setGroupId(n),void 0!==o&&t.setPoints(o)&&(b=!0),void 0!==r&&t.setStyles(r)&&(b=!0),void 0!==a&&t.setLock(a),void 0!==s&&t.setVisible(s)&&(b=!0),void 0!==l&&t.setMode(l),void 0!==c&&t.setExtendData(c)&&(b=!0),void 0!==u&&t.setOnDrawStartCallback(u),void 0!==h&&t.setOnDrawingCallback(h),void 0!==d&&t.setOnDrawEndCallback(d),void 0!==p&&t.setOnClickCallback(p),void 0!==v&&t.setOnRightClickCallback(v),void 0!==g&&t.setOnPressedMoveStartCallback(g),void 0!==f&&t.setOnPressedMovingCallback(f),void 0!==m&&t.setOnPressedMoveEndCallback(m),void 0!==y&&t.setOnMouseEnterCallback(y),void 0!==_&&t.setOnMouseLeaveCallback(_),void 0!==x&&t.setOnRemovedCallback(x),void 0!==S&&t.setOnSelectedCallback(S),void 0!==C&&t.setOnDeselectedCallback(C),b},t.prototype.getInstanceById=function(t){var e,i;try{for(var n=M(this._instances),o=n.next();!o.done;o=n.next()){var r=o.value[1].find((function(e){return e.id===t}));if(void 0!==r)return r}}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}return null!==this._progressInstanceInfo&&this._progressInstanceInfo.instance.id===t?this._progressInstanceInfo.instance:null},t.prototype.addInstance=function(t,e,i){var n,o,r,a,s=null!==(n=t.id)&&void 0!==n?n:B("overlay_");if(null===this.getInstanceById(s)){var l=new(Bt(t.name)),c=null!==(o=t.groupId)&&void 0!==o?o:s;return t.id=s,t.groupId=c,this._overrideInstance(l,t),l.isDrawing()?this._progressInstanceInfo={paneId:e,instance:l,appointPaneFlag:i}:(this._instances.has(e)||this._instances.set(e,[]),null===(r=this._instances.get(e))||void 0===r||r.push(l)),null===(a=l.onDrawStart)||void 0===a||a.call(l,{overlay:l}),this._chartStore.getChart().updatePane(1,e),s}return null},t.prototype.getProgressInstanceInfo=function(){return this._progressInstanceInfo},t.prototype.progressInstanceComplete=function(){var t;if(null!==this._progressInstanceInfo){var e=this._progressInstanceInfo,i=e.instance,n=e.paneId;i.isDrawing()||(this._instances.has(n)||this._instances.set(n,[]),null===(t=this._instances.get(n))||void 0===t||t.push(i),this._progressInstanceInfo=null)}},t.prototype.updateProgressInstanceInfo=function(t,e){null!==this._progressInstanceInfo&&(void 0!==e&&e&&(this._progressInstanceInfo.appointPaneFlag=e),this._progressInstanceInfo.paneId=t)},t.prototype.getInstances=function(t){var e;if(void 0===t){var i=[];return this._instances.forEach((function(t){i=i.concat(t)})),i}return null!==(e=this._instances.get(t))&&void 0!==e?e:[]},t.prototype.override=function(t){var e=this,i=t.id,n=t.groupId,o=t.name,r=!1;if(void 0!==i){var a=this.getInstanceById(i);null!==a&&this._overrideInstance(a,t)&&(r=!0)}else if(this._instances.forEach((function(i){i.forEach((function(i){(void 0!==o&&i.name===o||void 0!==n&&i.groupId===n||void 0===o&&void 0===n)&&e._overrideInstance(i,t)&&(r=!0)}))})),null!==this._progressInstanceInfo){var s=this._progressInstanceInfo.instance;(void 0!==o&&s.name===o||void 0!==n&&s.groupId===n||void 0===o&&void 0===n)&&this._overrideInstance(s,t)&&(r=!0)}r&&this._chartStore.getChart().updatePane(1)},t.prototype.removeInstance=function(t){var e,i,n,o=function(t,e){if(void 0!==t.id){if(e.id!==t.id)return!1}else if(void 0!==t.groupId){if(e.groupId!==t.groupId)return!1}else if(void 0!==t.name&&e.name!==t.name)return!1;return!0},r=[];if(null!==this._progressInstanceInfo){var a=this._progressInstanceInfo.instance;(void 0===t||void 0!==t&&o(t,a))&&(r.push(this._progressInstanceInfo.paneId),null===(n=a.onRemoved)||void 0===n||n.call(a,{overlay:a}),this._progressInstanceInfo=null)}if(void 0!==t){var s=new Map,l=function(e){var i=e[1].filter((function(i){var n;return!o(t,i)||(r.includes(e[0])||r.push(e[0]),null===(n=i.onRemoved)||void 0===n||n.call(i,{overlay:i}),!1)}));i.length>0&&s.set(e[0],i)};try{for(var c=M(this._instances),u=c.next();!u.done;u=c.next()){l(u.value)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}this._instances=s}else this._instances.forEach((function(t,e){r.push(e),t.forEach((function(t){var e;null===(e=t.onRemoved)||void 0===e||e.call(t,{overlay:t})}))})),this._instances.clear();if(r.length>0){var h=this._chartStore.getChart();r.forEach((function(t){h.updatePane(1,t)})),h.updatePane(1,Ut)}},t.prototype.setPressedInstanceInfo=function(t){this._pressedInstanceInfo=t},t.prototype.getPressedInstanceInfo=function(){return this._pressedInstanceInfo},t.prototype.setHoverInstanceInfo=function(t,e){var i,n,o,r,a,s=this._hoverInstanceInfo,l=s.instance,c=s.figureType,u=s.figureIndex;(null==l?void 0:l.id)===(null===(i=t.instance)||void 0===i?void 0:i.id)&&c===t.figureType&&u===t.figureIndex||(this._hoverInstanceInfo=t,(null==l?void 0:l.id)!==(null===(n=t.instance)||void 0===n?void 0:n.id)&&(null===(o=null==l?void 0:l.onMouseLeave)||void 0===o||o.call(l,E({overlay:l},e)),null===(a=null===(r=t.instance)||void 0===r?void 0:r.onMouseEnter)||void 0===a||a.call(r,E({overlay:t.instance},e))))},t.prototype.getHoverInstanceInfo=function(){return this._hoverInstanceInfo},t.prototype.setClickInstanceInfo=function(t,e){var i,n,o,r,a,s,l,c,u,h=this._clickInstanceInfo,d=h.paneId,p=h.instance,v=h.figureType,g=h.figureIndex;if(null!==(n=null===(i=t.instance)||void 0===i?void 0:i.isDrawing())&&void 0!==n&&n||null===(r=null===(o=t.instance)||void 0===o?void 0:o.onClick)||void 0===r||r.call(o,E({overlay:t.instance},e)),((null==p?void 0:p.id)!==(null===(a=t.instance)||void 0===a?void 0:a.id)||v!==t.figureType||g!==t.figureIndex)&&(this._clickInstanceInfo=t,(null==p?void 0:p.id)!==(null===(s=t.instance)||void 0===s?void 0:s.id))){null===(l=null==p?void 0:p.onDeselected)||void 0===l||l.call(p,E({overlay:p},e)),null===(u=null===(c=t.instance)||void 0===c?void 0:c.onSelected)||void 0===u||u.call(c,E({overlay:t.instance},e));var f=this._chartStore.getChart();f.updatePane(1,t.paneId),d!==t.paneId&&f.updatePane(1,d),f.updatePane(1,Ut)}},t.prototype.getClickInstanceInfo=function(){return this._clickInstanceInfo},t.prototype.isEmpty=function(){return 0===this._instances.size&&null===this._progressInstanceInfo},t.prototype.isDrawing=function(){var t,e;return null!==this._progressInstanceInfo&&null!==(e=null===(t=this._progressInstanceInfo)||void 0===t?void 0:t.instance.isDrawing())&&void 0!==e&&e},t}(),Kt=function(){function t(){this._actions=new Map}return t.prototype.execute=function(t,e){var i;null===(i=this._actions.get(t))||void 0===i||i.execute(e)},t.prototype.subscribe=function(t,e){var i;this._actions.has(t)||this._actions.set(t,new L),null===(i=this._actions.get(t))||void 0===i||i.subscribe(e)},t.prototype.unsubscribe=function(t,e){var i=this._actions.get(t);void 0!==i&&(i.unsubscribe(e),i.isEmpty()&&this._actions.delete(t))},t.prototype.has=function(t){var e=this._actions.get(t);return void 0!==e&&!e.isEmpty()},t}(),$t={light:{grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},dark:{grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}}};function Jt(t){var e;return null!==(e=$t[t])&&void 0!==e?e:null}var Qt=function(){function i(e,i){this._styles={grid:{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:t.LineType.Dashed,dashedValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:t.LineType.Dashed,dashedValue:[2,2]}},candle:{type:t.CandleType.CandleSolid,bar:{upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#999999"},area:{lineSize:2,lineColor:"#1677FF",value:"close",backgroundColor:[{offset:0,color:"rgba(22, 119, 255, 0.01)"},{offset:1,color:"rgba(22, 119, 255, 0.2)"}]},priceMark:{show:!0,high:{show:!0,color:"#76808F",textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},low:{show:!0,color:"#76808F",textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},last:{show:!0,upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#888888",line:{show:!0,style:t.LineType.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:t.PolygonType.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],color:"#FFFFFF",family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{showRule:t.TooltipShowRule.Always,showType:t.TooltipShowType.Standard,custom:null,defaultValue:"n/a",rect:{paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:8,offsetLeft:10,offsetTop:8,offsetRight:10,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},indicator:{ohlc:{upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"},bars:[{style:t.PolygonType.Fill,borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"}],lines:[{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#FF9600"},{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#9D65C9"},{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#1677FF"},{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#E11D74"},{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#01C5C4"}],circles:[{style:t.PolygonType.Fill,borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"}],lastValueMark:{show:!1,text:{show:!1,style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{showRule:t.TooltipShowRule.Always,showType:t.TooltipShowType.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},xAxis:{show:!0,size:"auto",axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},yAxis:{show:!0,size:"auto",type:t.YAxisType.Normal,position:t.YAxisPosition.Right,inside:!1,reverse:!1,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},separator:{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:"rgba(33, 150, 243, 0.08)"},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:t.LineType.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:"#686D76",borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}},vertical:{show:!0,line:{show:!0,style:t.LineType.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#686D76",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}}},overlay:{point:{color:"#1677FF",borderColor:"rgba(22, 119, 255, 0.35)",borderSize:1,radius:5,activeColor:"#1677FF",activeBorderColor:"rgba(22, 119, 255, 0.35)",activeBorderSize:3,activeRadius:5},line:{style:t.LineType.Solid,smooth:!1,color:"#1677FF",size:1,dashedValue:[2,2]},rect:{style:t.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderRadius:0,borderStyle:t.LineType.Solid,borderDashedValue:[2,2]},polygon:{style:t.PolygonType.Fill,color:"#1677FF",borderColor:"#1677FF",borderSize:1,borderStyle:t.LineType.Solid,borderDashedValue:[2,2]},circle:{style:t.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderStyle:t.LineType.Solid,borderDashedValue:[2,2]},arc:{style:t.LineType.Solid,color:"#1677FF",size:1,dashedValue:[2,2]},text:{color:"#1677FF",size:12,family:"Helvetica Neue",weight:"normal"},rectText:{style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"}}},this._customApi={formatDate:S,formatBigNumber:b},this._locale="en-US",this._precision={price:2,volume:0},this._dataList=[],this._timeScaleStore=new Z(this),this._indicatorStore=new _t(this),this._overlayStore=new Zt(this),this._crosshairStore=new xt(this),this._tooltipStore=new St,this._actionStore=new Kt,this._visibleDataList=[],this._chart=e,this.setOptions(i)}return i.prototype.adjustVisibleDataList=function(){this._visibleDataList=[];for(var t=this._timeScaleStore.getVisibleRange(),e=t.from,i=t.to,n=e;n<i;n++){var o=this._dataList[n],r=this._timeScaleStore.dataIndexToCoordinate(n);this._visibleDataList.push({dataIndex:n,x:r,data:o})}},i.prototype.setOptions=function(t){if(void 0!==t){var i=t.locale,n=t.timezone,o=t.styles,r=t.customApi;void 0!==i&&(this._locale=i),void 0!==n&&this._timeScaleStore.setTimezone(n),void 0!==o&&(l(o)?e(this._styles,Jt(o)):e(this._styles,o)),void 0!==r&&e(this._customApi,r)}return this},i.prototype.getStyles=function(){return this._styles},i.prototype.getLocale=function(){return this._locale},i.prototype.getCustomApi=function(){return this._customApi},i.prototype.getPrecision=function(){return this._precision},i.prototype.setPrecision=function(t){return this._precision=t,this._indicatorStore.setSeriesPrecision(t),this},i.prototype.getDataList=function(){return this._dataList},i.prototype.getVisibleDataList=function(){return this._visibleDataList},i.prototype.addData=function(t,e,i){if(n(t)){this._timeScaleStore.setLoading(!1),this._timeScaleStore.setMore(null==i||i);var o=0===this._dataList.length;this._dataList=t.concat(this._dataList),o&&this._timeScaleStore.resetOffsetRightDistance(),this._timeScaleStore.adjustVisibleRange()}else{if(e>=this._dataList.length){this._dataList.push(t);var r=this._timeScaleStore.getOffsetRightBarCount();r<0&&this._timeScaleStore.setOffsetRightBarCount(--r),this._timeScaleStore.adjustVisibleRange()}else this._dataList[e]=t,this.adjustVisibleDataList()}this._crosshairStore.recalculate(!0)},i.prototype.clearDataList=function(){this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear()},i.prototype.getTimeScaleStore=function(){return this._timeScaleStore},i.prototype.getIndicatorStore=function(){return this._indicatorStore},i.prototype.getOverlayStore=function(){return this._overlayStore},i.prototype.getCrosshairStore=function(){return this._crosshairStore},i.prototype.getTooltipStore=function(){return this._tooltipStore},i.prototype.getActionStore=function(){return this._actionStore},i.prototype.getChart=function(){return this._chart},i}();function te(t){return null==window.requestAnimationFrame?window.setTimeout(t,20):window.requestAnimationFrame(t)}function ee(t){null==window.cancelAnimationFrame&&window.clearTimeout(t),window.cancelAnimationFrame(t)}var ie=-1,ne=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._mainRequestAnimationId=ie,e._overlayRequestAnimationId=ie,e}return T(e,t),e.prototype.getContainerStyle=function(){return{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box"}},e.prototype.initDom=function(t){this._mainCanvas=O("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._mainCtx=this._mainCanvas.getContext("2d"),this._overlayCanvas=O("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._overlayCtx=this._overlayCanvas.getContext("2d"),t.appendChild(this._mainCanvas),t.appendChild(this._overlayCanvas)},e.prototype._optimalUpdateMain=function(t,e){var i=this;this._mainRequestAnimationId!==ie&&(ee(this._mainRequestAnimationId),this._mainRequestAnimationId=ie),this._mainRequestAnimationId=te((function(){if(t!==i._mainCanvas.offsetWidth||e!==i._mainCanvas.offsetHeight){i._mainCtx.clearRect(0,0,i._mainCanvas.offsetWidth,i._mainCanvas.offsetHeight);var n=V(i._mainCanvas),o=Math.floor(t*n),r=Math.floor(e*n);i._mainCanvas.style.width="".concat(t,"px"),i._mainCanvas.style.height="".concat(e,"px"),i._mainCanvas.width=o,i._mainCanvas.height=r,i._mainCtx.scale(n,n)}else i._mainCtx.clearRect(0,0,i._mainCanvas.offsetWidth,i._mainCanvas.offsetHeight);i.updateMain(i._mainCtx)}))},e.prototype._optimalUpdateOverlay=function(t,e){var i=this;this._overlayRequestAnimationId!==ie&&(ee(this._overlayRequestAnimationId),this._overlayRequestAnimationId=ie),this._overlayRequestAnimationId=te((function(){if(t!==i._overlayCanvas.offsetWidth||e!==i._overlayCanvas.offsetHeight){i._overlayCtx.clearRect(0,0,i._overlayCanvas.offsetWidth,i._overlayCanvas.offsetHeight);var n=V(i._overlayCanvas),o=Math.floor(t*n),r=Math.floor(e*n);i._overlayCanvas.style.width="".concat(t,"px"),i._overlayCanvas.style.height="".concat(e,"px"),i._overlayCanvas.width=o,i._overlayCanvas.height=r,i._overlayCtx.scale(n,n)}else i._overlayCtx.clearRect(0,0,i._overlayCanvas.offsetWidth,i._overlayCanvas.offsetHeight);i.updateOverlay(i._overlayCtx)}))},e.prototype.updateImp=function(t,e,i){var n=i.width,o=i.height,r=i.left;e.style.left="".concat(r,"px");var a=t;switch(n===e.offsetWidth&&o===e.offsetHeight||(e.style.width="".concat(n,"px"),e.style.height="".concat(o,"px"),a=3),a){case 0:this._optimalUpdateMain(n,o);break;case 1:this._optimalUpdateOverlay(n,o);break;case 3:case 4:this._optimalUpdateMain(n,o),this._optimalUpdateOverlay(n,o)}},e.prototype.getImage=function(t){var e=this.getBounding(),i=e.width,n=e.height,o=O("canvas",{width:"".concat(i,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),r=o.getContext("2d"),a=V(o);return o.width=i*a,o.height=n*a,r.scale(a,a),r.drawImage(this._mainCanvas,0,0,i,n),t&&r.drawImage(this._overlayCanvas,0,0,i,n),o},e}(Ht),oe=2,re=function(t){function e(e){var i=t.call(this)||this;return i.attrs=e.attrs,i.styles=e.styles,i}return T(e,t),e.prototype.checkEventOn=function(t){return this.checkEventOnImp(t,this.attrs,this.styles)},e.prototype.draw=function(t){this.drawImp(t,this.attrs,this.styles)},e.extend=function(t){var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return T(i,e),i.prototype.checkEventOnImp=function(e,i,n){return t.checkEventOn(e,i,n)},i.prototype.drawImp=function(e,i,n){t.draw(e,i,n)},i}(e);return i},e}(Vt);function ae(t,e){var i=t.x-e.x,n=t.y-e.y,o=e.r;return!(i*i+n*n>o*o)}function se(e,i,n){var o=i.x,r=i.y,a=i.r,s=n.style,l=void 0===s?t.PolygonType.Fill:s,c=n.color,u=void 0===c?"currentColor":c,h=n.borderSize,d=void 0===h?1:h,p=n.borderColor,v=void 0===p?"currentColor":p,g=n.borderStyle,f=void 0===g?t.LineType.Solid:g,m=n.borderDashedValue,y=void 0===m?[2,2]:m;l!==t.PolygonType.Fill&&n.style!==t.PolygonType.StrokeFill||(e.fillStyle=u,e.beginPath(),e.arc(o,r,a,0,2*Math.PI),e.closePath(),e.fill()),l!==t.PolygonType.Stroke&&n.style!==t.PolygonType.StrokeFill||(e.strokeStyle=v,e.lineWidth=d,f===t.LineType.Dashed?e.setLineDash(y):e.setLineDash([]),e.beginPath(),e.arc(o,r,a,0,2*Math.PI),e.closePath(),e.stroke())}var le={name:"circle",checkEventOn:ae,draw:function(t,e,i){se(t,e,i)}};function ce(t,e){for(var i=!1,n=e.coordinates,o=0,r=n.length-1;o<n.length;r=o++)n[o].y>t.y!=n[r].y>t.y&&t.x<(n[r].x-n[o].x)*(t.y-n[o].y)/(n[r].y-n[o].y)+n[o].x&&(i=!i);return i}function ue(e,i,n){var o=i.coordinates,r=n.style,a=void 0===r?t.PolygonType.Fill:r,s=n.color,l=void 0===s?"currentColor":s,c=n.borderSize,u=void 0===c?1:c,h=n.borderColor,d=void 0===h?"currentColor":h,p=n.borderStyle,v=void 0===p?t.LineType.Solid:p,g=n.borderDashedValue,f=void 0===g?[2,2]:g;if(a===t.PolygonType.Fill||n.style===t.PolygonType.StrokeFill){e.fillStyle=l,e.beginPath(),e.moveTo(o[0].x,o[0].y);for(var m=1;m<o.length;m++)e.lineTo(o[m].x,o[m].y);e.closePath(),e.fill()}if(a===t.PolygonType.Stroke||n.style===t.PolygonType.StrokeFill){e.strokeStyle=d,e.lineWidth=u,v===t.LineType.Dashed?e.setLineDash(f):e.setLineDash([]),e.beginPath(),e.moveTo(o[0].x,o[0].y);for(m=1;m<o.length;m++)e.lineTo(o[m].x,o[m].y);e.closePath(),e.stroke()}}var he={name:"polygon",checkEventOn:ce,draw:function(t,e,i){ue(t,e,i)}};function de(t,e){return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height}function pe(e,i,n){var o=i.x,r=i.y,a=i.width,s=i.height,l=n.style,c=void 0===l?t.PolygonType.Fill:l,u=n.color,h=void 0===u?"currentColor":u,d=n.borderSize,p=void 0===d?1:d,v=n.borderColor,g=void 0===v?"currentColor":v,f=n.borderStyle,m=void 0===f?t.LineType.Solid:f,y=n.borderRadius,_=void 0===y?0:y,x=n.borderDashedValue,S=void 0===x?[2,2]:x;c!==t.PolygonType.Fill&&n.style!==t.PolygonType.StrokeFill||(e.fillStyle=h,e.beginPath(),e.moveTo(o+_,r),e.arcTo(o+a,r,o+a,r+s,_),e.arcTo(o+a,r+s,o,r+s,_),e.arcTo(o,r+s,o,r,_),e.arcTo(o,r,o+a,r,_),e.closePath(),e.fill()),c!==t.PolygonType.Stroke&&n.style!==t.PolygonType.StrokeFill||(e.strokeStyle=g,e.lineWidth=p,m===t.LineType.Dashed?e.setLineDash(S):e.setLineDash([]),e.beginPath(),e.moveTo(o+_,r),e.arcTo(o+a,r,o+a,r+s,_),e.arcTo(o+a,r+s,o,r+s,_),e.arcTo(o,r+s,o,r,_),e.arcTo(o,r,o+a,r,_),e.closePath(),e.stroke())}var ve={name:"rect",checkEventOn:de,draw:function(t,e,i){pe(t,e,i)}};function ge(t,e,i){var n=e.size,o=void 0===n?12:n,r=e.paddingLeft,a=void 0===r?0:r,s=e.paddingTop,l=void 0===s?0:s,c=e.paddingRight,u=void 0===c?0:c,h=e.paddingBottom,d=void 0===h?0:h,p=t.x,v=t.y,g=t.text,f=t.align,m=void 0===f?"left":f,y=t.baseline,_=void 0===y?"top":y,x=g.length;i=null!=i?i:o*x;var S,C,b=o;switch(m){case"left":case"start":S=p;break;case"right":case"end":S=p-u-i-a;break;default:S=p-i/2-a}switch(_){case"top":case"hanging":C=v;break;case"bottom":case"ideographic":case"alphabetic":C=v-b-l-d;break;default:C=v-b/2-l}return{x:S,y:C,width:a+i+u,height:l+b+d}}function fe(t,e,i){var n=ge(e,i),o=n.x,r=n.y,a=n.width,s=n.height;return t.x>=o&&t.x<=o+a&&t.y>=r&&t.y<=r+s}function me(t,e,i){var n=e.x,o=e.y,r=e.text,a=e.align,s=void 0===a?"left":a,l=e.baseline,c=void 0===l?"top":l,u=i.color,h=void 0===u?"currentColor":u,d=i.size,p=void 0===d?12:d,v=i.family,g=i.weight;t.textAlign=s,t.textBaseline=c,t.font=N(p,g,v),t.fillStyle=h,t.fillText(r,n,o)}var ye={name:"text",checkEventOn:function(t,e,i){return fe(t,e,i)},draw:function(t,e,i){me(t,e,i)}};function _e(t,e,i){var n=e.text,o=i.size,r=void 0===o?12:o,a=i.family,s=i.weight,l=i.paddingLeft,c=void 0===l?0:l,u=i.paddingTop,h=void 0===u?0:u;t.font=N(r,s,a);var d=ge(e,i,t.measureText(n).width);pe(t,d,E(E({},i),{color:i.backgroundColor})),me(t,{x:d.x+c,y:d.y+h,text:n,align:"left",baseline:"top"},i)}var xe={name:"rectText",checkEventOn:function(t,e,i){return fe(t,e,i)},draw:function(t,e,i){_e(t,e,i)}};function Se(t,e){if(Math.abs((u=e,h=(c=t).x-u.x,d=c.y-u.y,Math.sqrt(h*h+d*d)-e.r))<oe){var i=e.r,n=e.startAngle,o=e.endAngle,r=i*Math.cos(n)+e.x,a=i*Math.sin(n)+e.y,s=i*Math.cos(o)+e.x,l=i*Math.sin(o)+e.y;return t.x<=Math.max(r,s)+oe&&t.x>=Math.min(r,s)-oe&&t.y<=Math.max(a,l)+oe&&t.y>=Math.min(a,l)-oe}var c,u,h,d;return!1}function Ce(e,i,n){var o=i.x,r=i.y,a=i.r,s=i.startAngle,l=i.endAngle,c=n.style,u=void 0===c?t.LineType.Solid:c,h=n.size,d=void 0===h?1:h,p=n.color,v=void 0===p?"currentColor":p,g=n.dashedValue,f=void 0===g?[2,2]:g;e.lineWidth=d,e.strokeStyle=v,u===t.LineType.Dashed?e.setLineDash(f):e.setLineDash([]),e.beginPath(),e.arc(o,r,a,s,l),e.stroke(),e.closePath()}var be={name:"arc",checkEventOn:Se,draw:function(t,e,i){Ce(t,e,i)}},we={};[le,Mt,he,ve,ye,xe,be].forEach((function(t){we[t.name]=re.extend(t)}));var Te=function(t){function e(e){var i=t.call(this)||this;return i._widget=e,i}return T(e,t),e.prototype.getWidget=function(){return this._widget},e.prototype.createFigure=function(t,e,i,n){var o=function(t){var e;return null!==(e=we[t])&&void 0!==e?e:null}(t);if(null!==o){var r=new o({name:t,attrs:e,styles:i});if(void 0!==n){for(var a in n)n.hasOwnProperty(a)&&r.registerEvent(a,n[a]);this.addChild(r)}return r}return null},e.prototype.draw=function(t){this.clear(),this.drawImp(t)},e}(Vt),Ie=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.drawImp=function(t){var e,i=this,n=this.getWidget(),o=this.getWidget().getPane(),r=o.getChart(),a=n.getBounding(),s=r.getStyles().grid;if(s.show){t.save(),t.globalCompositeOperation="destination-over";var l=s.horizontal;if(l.show)o.getAxisComponent().getTicks().forEach((function(e){var n;null===(n=i.createFigure("line",{coordinates:[{x:0,y:e.coord},{x:a.width,y:e.coord}]},l))||void 0===n||n.draw(t)}));var c=s.vertical;if(c.show)(null===(e=r.getPaneById(Ut))||void 0===e?void 0:e.getAxisComponent()).getTicks().forEach((function(e){var n;null===(n=i.createFigure("line",{coordinates:[{x:e.coord,y:0},{x:e.coord,y:a.height}]},c))||void 0===n||n.draw(t)}));t.restore()}},e}(Te),Ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.eachChildren=function(t){var e=this.getWidget().getPane().getChart().getChartStore(),i=e.getVisibleDataList(),n=e.getTimeScaleStore().getBarSpace();i.forEach((function(e,i){t(e,n,i)}))},e}(Te),Pe=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i._boundCandleBarClickEvent=function(e){return function(){return i.getWidget().getPane().getChart().getChartStore().getActionStore().execute(t.ActionType.OnCandleBarClick,e),!1}},i}return T(i,e),i.prototype.drawImp=function(t){var e=this,i=this.getWidget().getPane(),n=i.getId()===jt,o=i.getChart().getChartStore(),r=this.getCandleBarOptions(o);if(null!==r){var a=i.getAxisComponent();this.eachChildren((function(i,o){e._drawCandleBar(t,a,i,o,r,n)}))}},i.prototype.getCandleBarOptions=function(t){var e=t.getStyles().candle;return{type:e.type,styles:e.bar}},i.prototype._drawCandleBar=function(e,i,n,o,r,a){var s,l=this,c=n.data,u=n.x,h=c.open,d=c.high,p=c.low,v=c.close,g=o.halfGapBar,f=o.gapBar,m=r.type,y=r.styles;s=v>h?y.upColor:v<h?y.downColor:y.noChangeColor;var _=i.convertToPixel(h),x=i.convertToPixel(v),S=[_,x,i.convertToPixel(d),i.convertToPixel(p)];S.sort((function(t,e){return t-e}));var C=Math.max(1,S[2]-S[1]),b=[];m!==t.CandleType.Ohlc?(b.push({name:"rect",attrs:{x:u-.5,y:S[0],width:1,height:S[1]-S[0]},styles:{color:s}}),m===t.CandleType.CandleStroke||m===t.CandleType.CandleUpStroke&&h<v||m===t.CandleType.CandleDownStroke&&h>v?b.push({name:"rect",attrs:{x:u-g+.5,y:S[1],width:f-1,height:C},styles:{style:t.PolygonType.Stroke,borderColor:s}}):b.push({name:"rect",attrs:{x:u-g,y:S[1],width:f,height:C},styles:{color:s}}),b.push({name:"rect",attrs:{x:u-.5,y:S[2],width:1,height:S[3]-S[2]},styles:{color:s}})):b=[{name:"rect",attrs:{x:u-.5,y:S[0],width:1,height:S[3]-S[0]},styles:{color:s}},{name:"rect",attrs:{x:u-g,y:_,width:g,height:1},styles:{color:s}},{name:"rect",attrs:{x:u,y:x,width:g,height:1},styles:{color:s}}],b.forEach((function(t){var i,o,r=t.attrs,s=t.styles;a&&(o={mouseClickEvent:l._boundCandleBarClickEvent(n)}),null===(i=l.createFigure("rect",r,s,o))||void 0===i||i.draw(e)}))},i}(Ee),De=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return T(i,e),i.prototype.getCandleBarOptions=function(e){var i,n,o=this.getWidget().getPane();if(!o.getAxisComponent().isInCandle()){var r=e.getIndicatorStore().getInstances(o.getId());try{for(var a=M(r),s=a.next();!s.done;s=a.next()){var l=s.value[1];if(l.shouldOhlc&&l.visible){var c=l.styles,u=e.getStyles().indicator;return{type:t.CandleType.Ohlc,styles:{upColor:x(c,"ohlc.upColor",u.ohlc.upColor),downColor:x(c,"ohlc.downColor",u.ohlc.downColor),noChangeColor:x(c,"ohlc.noChangeColor",u.ohlc.noChangeColor)}}}}}catch(t){i={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}}return null},i.prototype.drawImp=function(t){var i,n=this;e.prototype.drawImp.call(this,t);var o=this.getWidget(),r=o.getPane(),a=r.getChart(),l=o.getBounding(),c=null===(i=a.getPaneById(Ut))||void 0===i?void 0:i.getAxisComponent(),u=r.getAxisComponent(),h=a.getChartStore(),d=h.getDataList(),p=h.getTimeScaleStore(),v=p.getVisibleRange(),g=h.getIndicatorStore().getInstances(r.getId()),f=h.getStyles().indicator;g.forEach((function(e){var i;if(e.visible){var o=!1;if(null!==e.draw&&(t.save(),o=null!==(i=e.draw({ctx:t,kLineDataList:d,indicator:e,visibleRange:v,bounding:l,barSpace:p.getBarSpace(),defaultStyles:f,xAxis:c,yAxis:u}))&&void 0!==i&&i,t.restore()),!o){var r=e.result,a=[],h=[],g=[];n.eachChildren((function(i,o){var l,c=o.halfGapBar,p=o.gapBar,m=i.dataIndex,y=i.x,_=null!==(l=r[m])&&void 0!==l?l:{};K(d,e,m,f,(function(e,i,o,r){var l,d,f,x=_[e.key],S=u.convertToPixel(x);switch(e.type){case"circle":s(x)&&(null===(l=n.createFigure("circle",{x:y,y:S,r:c},{style:i.style,color:i.color,borderColor:i.color}))||void 0===l||l.draw(t));break;case"bar":if(s(x)){var C=null!==(d=e.baseValue)&&void 0!==d?d:u.getExtremum().min,b=u.convertToPixel(C),w=Math.abs(b-S);C!==x&&(w=Math.max(1,w));var T=void 0;T=S>b?b:S,null===(f=n.createFigure("rect",{x:y-c,y:T,width:p,height:w},{style:i.style,color:i.color,borderColor:i.color}))||void 0===f||f.draw(t)}break;case"line":var I=null;if(s(x)){I=i;var E={x:y,y:S},P=a[r];s(h[r])||(h[r]=[]),h[r].push(E),s(P)&&((null==P?void 0:P.color)!==i.color||(null==P?void 0:P.style)!==i.style)&&(g.push({name:"line",attrs:{coordinates:h[r]},styles:{style:i.style,color:i.color,size:o.size,smooth:o.smooth,dashedValue:o.dashedValue}}),h[r]=[E]),m===v.to-1&&g.push({name:"line",attrs:{coordinates:h[r]},styles:{style:i.style,color:null==i?void 0:i.color,size:o.size,smooth:o.smooth,dashedValue:o.dashedValue}})}a[r]=I}}))})),g.forEach((function(e){var i,o=e.attrs,r=e.styles;null===(i=n.createFigure("line",o,r))||void 0===i||i.draw(t)}))}}}))},i}(Pe),Me=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane(),n=e.getBounding(),o=e.getPane().getChart().getChartStore(),r=o.getCrosshairStore().get(),a=o.getStyles().crosshair;if(void 0!==r.paneId&&a.show){if(r.paneId===i.getId()){var s=r.y;this._drawLine(t,[{x:0,y:s},{x:n.width,y:s}],a.horizontal)}var l=r.realX;this._drawLine(t,[{x:l,y:0},{x:l,y:n.height}],a.vertical)}},e.prototype._drawLine=function(t,e,i){var n;if(i.show){var o=i.line;o.show&&(null===(n=this.createFigure("line",{coordinates:e},o))||void 0===n||n.draw(t))}},e}(Te),ke=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i._boundIconClickEvent=function(e,n){return function(){return i.getWidget().getPane().getChart().getChartStore().getActionStore().execute(t.ActionType.OnTooltipIconClick,E(E({},e),{iconId:n})),!0}},i._boundIconMouseMoveEvent=function(t,e){return function(){return i.getWidget().getPane().getChart().getChartStore().getTooltipStore().setActiveIconInfo(E(E({},t),{iconId:e})),!0}},i}return T(i,e),i.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane(),n=i.getChart().getChartStore(),o=n.getCrosshairStore().get();if(void 0!==o.kLineData){var r=e.getBounding(),a=n.getCustomApi(),s=n.getIndicatorStore().getInstances(i.getId()),l=n.getTooltipStore().getActiveIconInfo(),c=n.getStyles().indicator;this.drawIndicatorTooltip(t,i.getId(),n.getDataList(),o,l,s,a,r,c)}},i.prototype.drawIndicatorTooltip=function(t,e,i,n,o,r,a,s,l,c){var u=this,h=l.tooltip,d=0;if(this.isDrawTooltip(n,h)){var p=h.text,v=0,g=null!=c?c:0,f=0;r.forEach((function(r){var c=u.getIndicatorTooltipData(i,n,r,a,l),h=c.name,m=c.calcParamsText,y=c.values,_=c.icons,x=h.length>0,S=y.length>0;if(x||S){var C=k(u.classifyTooltipIcons(_),3),b=C[0],w=C[1],T=C[2],I=k(u.drawStandardTooltipIcons(t,s,{paneId:e,indicatorName:r.name,iconId:""},o,b,v,g,f),4),E=I[0],P=I[1],D=I[2],M=I[3];if(v=E,g=P,d+=M,f=D,x){var A=h;m.length>0&&(A="".concat(A).concat(m));var F=k(u.drawStandardTooltipLabels(t,s,[{title:{text:"",color:p.color},value:{text:A,color:p.color}}],v,g,f,p),4),L=F[0],R=F[1],B=F[2],O=F[3];v=L,g=R,d+=O,f=B}var V=k(u.drawStandardTooltipIcons(t,s,{paneId:e,indicatorName:r.name,iconId:""},o,w,v,g,f),4),N=V[0],W=V[1],z=V[2],Y=V[3];if(v=N,g=W,d+=Y,f=z,S){var H=k(u.drawStandardTooltipLabels(t,s,y,v,g,f,p),4),X=H[0],j=H[1],G=H[2],U=H[3];v=X,g=j,d+=U,f=G}var q=k(u.drawStandardTooltipIcons(t,s,{paneId:e,indicatorName:r.name,iconId:""},o,T,v,g,f),4),Z=q[1],K=q[2],$=q[3];v=0,d+=$,g=Z+K,f=0}}))}return d},i.prototype.drawStandardTooltipIcons=function(t,e,i,n,o,r,a,s){var l=this,c=r,u=a,h=0,d=0,p=0;return o.length>0&&(o.forEach((function(e){var i=e.marginLeft,n=e.marginTop,o=e.marginRight,r=e.marginBottom,a=e.paddingLeft,s=e.paddingTop,l=e.paddingRight,c=e.paddingBottom,u=e.size,p=e.fontFamily,v=e.icon;t.font=N(u,"normal",p),h+=i+a+t.measureText(v).width+l+o,d=Math.max(d,n+s+u+c+r)})),c+h>e.width?(c=o[0].marginLeft,u+=s,p=d):p=Math.max(0,d-s),o.forEach((function(e){var o,r=e.marginLeft,a=e.marginTop,s=e.marginRight,h=e.paddingLeft,d=e.paddingTop,p=e.paddingRight,v=e.paddingBottom,g=e.color,f=e.activeColor,m=e.size,y=e.fontFamily,_=e.icon,x=e.backgroundColor,S=e.activeBackgroundColor;c+=r;var C=(null==n?void 0:n.paneId)===i.paneId&&(null==n?void 0:n.indicatorName)===i.indicatorName&&(null==n?void 0:n.iconId)===e.id;null===(o=l.createFigure("rectText",{text:_,x:c,y:u+a},{paddingLeft:h,paddingTop:d,paddingRight:p,paddingBottom:v,color:C?f:g,size:m,family:y,backgroundColor:C?S:x},{mouseClickEvent:l._boundIconClickEvent(i,e.id),mouseMoveEvent:l._boundIconMouseMoveEvent(i,e.id)}))||void 0===o||o.draw(t),c+=h+t.measureText(_).width+p+s}))),[c,u,Math.max(s,d),p]},i.prototype.drawStandardTooltipLabels=function(t,e,i,n,o,r,a){var s=this,l=n,c=o,u=0,h=0,d=r;if(i.length>0){var p=a.marginLeft,v=a.marginTop,g=a.marginRight,f=a.marginBottom,m=a.size,y=a.family,_=a.weight;t.font=N(m,_,y),i.forEach((function(i){var n,o,r=i.title,a=i.value,x=t.measureText(r.text).width,S=t.measureText(a.text).width,C=m+v+f;l+p+(x+S)+g>e.width?(l=p,c+=C,h+=C):(l+=p,h+=Math.max(0,C-d)),u=Math.max(d,C),d=u,r.text.length>0&&(null===(n=s.createFigure("text",{x:l,y:c+v,text:r.text},{color:r.color,size:m,family:y,weight:_}))||void 0===n||n.draw(t),l+=x),null===(o=s.createFigure("text",{x:l,y:c+v,text:a.text},{color:a.color,size:m,family:y,weight:_}))||void 0===o||o.draw(t),l+=S+g}))}return[l,c,u,h]},i.prototype.isDrawTooltip=function(e,i){var n=i.showRule;return n===t.TooltipShowRule.Always||n===t.TooltipShowRule.FollowCross&&void 0!==e.paneId},i.prototype.getIndicatorTooltipData=function(t,e,i,n,o){var a,l,c,u=o.tooltip,h=u.showName?i.shortName:"",d="",p=i.calcParams;p.length>0&&u.showParams&&(d="(".concat(p.join(","),")"));var v={name:h,calcParamsText:d,values:[],icons:u.icons},g=e.dataIndex,f=null!==(a=i.result)&&void 0!==a?a:[],m=[];if(i.visible){var y=null!==(l=f[g])&&void 0!==l?l:{};K(t,i,g,o,(function(t,e){if(void 0!==t.title){var o=e.color,r=y[t.key];s(r)&&(r=C(r,i.precision),i.shouldFormatBigNumber&&(r=n.formatBigNumber(r))),m.push({title:{text:t.title,color:o},value:{text:null!=r?r:u.defaultValue,color:o}})}})),v.values=m}if(null!==i.createTooltipDataSource){var _=this.getWidget(),x=_.getPane(),S=x.getChart().getChartStore(),b=i.createTooltipDataSource({kLineDataList:t,indicator:i,visibleRange:S.getTimeScaleStore().getVisibleRange(),bounding:_.getBounding(),crosshair:e,defaultStyles:o,xAxis:null===(c=x.getChart().getPaneById(Ut))||void 0===c?void 0:c.getAxisComponent(),yAxis:x.getAxisComponent()}),w=b.name,T=b.calcParamsText,I=b.values,E=b.icons;if(void 0!==w&&u.showName&&(v.name=w),void 0!==T&&u.showParams&&(v.calcParamsText=T),void 0!==E&&(v.icons=E),void 0!==I&&i.visible){var P=[],D=o.tooltip.text.color;I.forEach((function(t){var e={text:"",color:D};r(t.title)?e=t.title:e.text=t.title;var i={text:"",color:D};r(t.value)?i=t.value:i.text=t.value,P.push({title:e,value:i})})),v.values=P}}return v},i.prototype.classifyTooltipIcons=function(e){var i=[],n=[],o=[];return e.forEach((function(e){switch(e.position){case t.TooltipIconPosition.Left:i.push(e);break;case t.TooltipIconPosition.Middle:n.push(e);break;case t.TooltipIconPosition.Right:o.push(e)}})),[i,n,o]},i}(Te),Ae=function(e){function i(t){var i=e.call(this,t)||this;return i._initEvent(),i}return T(i,e),i.prototype._initEvent=function(){var t=this,e=this.getWidget().getPane(),i=e.getId(),n=e.getChart().getChartStore().getOverlayStore();this.registerEvent("mouseMoveEvent",(function(e){var o,r=n.getProgressInstanceInfo();if(null!==r){var a=r.instance,s=r.paneId;return a.isStart()&&(n.updateProgressInstanceInfo(i),s=i),a.isDrawing()&&s===i&&(a.eventMoveForDrawing(t._coordinateToPoint(r.instance,e)),null===(o=a.onDrawing)||void 0===o||o.call(a,E({overlay:a},e))),t._figureMouseMoveEvent(r.instance,1,r.instance.points.length-1,0)(e)}return n.setHoverInstanceInfo({paneId:i,instance:null,figureType:0,figureIndex:-1,attrsIndex:-1},e),!1})).registerEvent("mouseClickEvent",(function(e){var o,r,a=n.getProgressInstanceInfo();if(null!==a){var s=a.instance,l=a.paneId;return s.isStart()&&(n.updateProgressInstanceInfo(i,!0),l=i),s.isDrawing()&&l===i&&(s.eventMoveForDrawing(t._coordinateToPoint(s,e)),null===(o=s.onDrawing)||void 0===o||o.call(s,E({overlay:s},e)),s.nextStep(),s.isDrawing()||(n.progressInstanceComplete(),null===(r=s.onDrawEnd)||void 0===r||r.call(s,E({overlay:s},e)))),t._figureMouseClickEvent(s,1,s.points.length-1,0)(e)}return n.setClickInstanceInfo({paneId:i,instance:null,figureType:0,figureIndex:-1,attrsIndex:-1},e),!1})).registerEvent("mouseDoubleClickEvent",(function(t){var e,o=n.getProgressInstanceInfo();if(null!==o){var r=o.instance,a=o.paneId;return r.isDrawing()&&a===i&&(r.forceComplete(),r.isDrawing()||(n.progressInstanceComplete(),null===(e=r.onDrawEnd)||void 0===e||e.call(r,E({overlay:r},t)))),!0}return!1})).registerEvent("mouseRightClickEvent",(function(e){var i=n.getProgressInstanceInfo();if(null!==i){var o=i.instance;if(o.isDrawing())return t._figureMouseRightClickEvent(o,1,o.points.length-1,0)(e)}return!1})).registerEvent("mouseUpEvent",(function(t){var e,o=n.getPressedInstanceInfo().instance;return null!==o&&(null===(e=o.onPressedMoveEnd)||void 0===e||e.call(o,E({overlay:o},t))),n.setPressedInstanceInfo({paneId:i,instance:null,figureType:0,figureIndex:-1,attrsIndex:-1}),!1})).registerEvent("pressedMouseMoveEvent",(function(e){var i,o,r=n.getPressedInstanceInfo(),a=r.instance,s=r.figureType,l=r.figureIndex;if(null!==a){if(!(a.lock||null!==(o=null===(i=a.onPressedMoving)||void 0===i?void 0:i.call(a,E({overlay:a},e)))&&void 0!==o&&o)){var c=t._coordinateToPoint(a,e);1===s?a.eventPressedPointMove(c,l):a.eventPressedOtherMove(c,t.getWidget().getPane().getChart().getChartStore().getTimeScaleStore())}return!0}return!1}))},i.prototype._createFigureEvents=function(t,e,i,n){if(!t.isDrawing())return{mouseMoveEvent:this._figureMouseMoveEvent(t,e,i,n),mouseDownEvent:this._figureMouseDownEvent(t,e,i,n),mouseClickEvent:this._figureMouseClickEvent(t,e,i,n),mouseRightClickEvent:this._figureMouseRightClickEvent(t,e,i,n)}},i.prototype._figureMouseMoveEvent=function(t,e,i,n){var o=this;return function(r){var a=o.getWidget().getPane();return a.getChart().getChartStore().getOverlayStore().setHoverInstanceInfo({paneId:a.getId(),instance:t,figureType:e,figureIndex:i,attrsIndex:n},r),!0}},i.prototype._figureMouseDownEvent=function(t,e,i,n){var o=this;return function(r){var a,s=o.getWidget().getPane(),l=s.getId(),c=s.getChart().getChartStore().getOverlayStore();return t.startPressedMove(o._coordinateToPoint(t,r)),null===(a=t.onPressedMoveStart)||void 0===a||a.call(t,E({overlay:t},r)),c.setPressedInstanceInfo({paneId:l,instance:t,figureType:e,figureIndex:i,attrsIndex:n}),!0}},i.prototype._figureMouseClickEvent=function(t,e,i,n){var o=this;return function(r){var a=o.getWidget().getPane(),s=a.getId();return a.getChart().getChartStore().getOverlayStore().setClickInstanceInfo({paneId:s,instance:t,figureType:e,figureIndex:i,attrsIndex:n},r),!0}},i.prototype._figureMouseRightClickEvent=function(t,e,i,n){var o=this;return function(e){var i,n;null!==(n=null===(i=t.onRightClick)||void 0===i?void 0:i.call(t,E({overlay:t},e)))&&void 0!==n&&n||o.getWidget().getPane().getChart().getChartStore().getOverlayStore().removeInstance(t);return!0}},i.prototype._coordinateToPoint=function(e,i){var n,o,r={},a=this.getWidget().getPane(),s=a.getChart(),l=a.getId(),c=s.getChartStore().getTimeScaleStore();if(this.coordinateToPointTimestampDataIndexFlag()){var u=(null===(n=s.getPaneById(Ut))||void 0===n?void 0:n.getAxisComponent()).convertFromPixel(i.x),h=null!==(o=c.dataIndexToTimestamp(u))&&void 0!==o?o:void 0;r.dataIndex=u,r.timestamp=h}if(this.coordinateToPointValueFlag()){var d=a.getAxisComponent(),p=d.convertFromPixel(i.y);if(e.mode!==t.OverlayMode.Normal&&l===jt&&void 0!==r.dataIndex){var v=c.getDataByDataIndex(r.dataIndex);if(null!==v)if(p>v.high)if(e.mode===t.OverlayMode.WeakMagnet){var g=d.convertToPixel(v.high);p<d.convertFromPixel(g-8)&&(p=v.high)}else p=v.high;else if(p<v.low)if(e.mode===t.OverlayMode.WeakMagnet){var f=d.convertToPixel(v.low);p>d.convertFromPixel(f-8)&&(p=v.low)}else p=v.low;else{var m=Math.max(v.open,v.close),y=Math.min(v.open,v.close);p=p>m?p-m<v.high-p?m:v.high:p<y?p-v.low<y-p?v.low:y:m-p<p-y?m:y}}r.value=p}return r},i.prototype.coordinateToPointValueFlag=function(){return!0},i.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},i.prototype.dispatchEvent=function(t,i,n){return this.getWidget().getPane().getChart().getChartStore().getOverlayStore().isDrawing()?this.onEvent(t,i,n):e.prototype.dispatchEvent.call(this,t,i,n)},i.prototype.checkEventOn=function(){return!0},i.prototype.drawImp=function(t){var e,i=this,n=this.getWidget(),o=n.getPane(),r=o.getId(),a=o.getChart(),s=o.getAxisComponent(),l=null===(e=a.getPaneById(Ut))||void 0===e?void 0:e.getAxisComponent(),c=n.getBounding(),u=a.getChartStore(),h=u.getCustomApi(),d=u.getTimeScaleStore(),p=d.getDateTimeFormat(),v=d.getBarSpace(),g=u.getPrecision(),f=u.getStyles().overlay,m=u.getOverlayStore(),y=m.getHoverInstanceInfo(),_=m.getClickInstanceInfo();this.getCompleteOverlays(m,r).forEach((function(e){e.visible&&i._drawOverlay(t,e,c,v,g,p,h,f,l,s,y,_,d)}));var x=m.getProgressInstanceInfo();if(null!==x){var S=this.getProgressOverlay(x,r);null!==S&&S.visible&&this._drawOverlay(t,S,c,v,g,p,h,f,l,s,y,_,d)}},i.prototype._drawOverlay=function(t,e,i,n,o,r,a,s,l,c,u,h,d){var p=e.points.map((function(t){var e,i,n=t.dataIndex;void 0!==t.timestamp&&(n=d.timestampToDataIndex(t.timestamp));var o={x:0,y:0};return void 0!==n&&(o.x=null!==(e=null==l?void 0:l.convertToPixel(n))&&void 0!==e?e:0),void 0!==t.value&&(o.y=null!==(i=null==c?void 0:c.convertToPixel(t.value))&&void 0!==i?i:0),o}));if(p.length>0){var v=(new Array).concat(this.getFigures(e,p,i,n,o,r,s,l,c));this.drawFigures(t,e,v,s)}this.drawDefaultFigures(t,e,p,i,o,r,a,s,l,c,u,h)},i.prototype.drawFigures=function(t,e,i,n){var o=this;i.forEach((function(i,r){var a=i.type,s=i.styles,l=i.attrs,c=i.ignoreEvent;[].concat(l).forEach((function(i,l){var u,h,d=null!=c&&c?void 0:o._createFigureEvents(e,2,r,l),p=E(E(E({},n[a]),null===(u=e.styles)||void 0===u?void 0:u[a]),s);null===(h=o.createFigure(a,i,p,d))||void 0===h||h.draw(t)}))}))},i.prototype.getCompleteOverlays=function(t,e){return t.getInstances(e)},i.prototype.getProgressOverlay=function(t,e){return t.paneId===e?t.instance:null},i.prototype.getFigures=function(t,e,i,n,o,r,a,s,l){var c,u;return null!==(u=null===(c=t.createPointFigures)||void 0===c?void 0:c.call(t,{overlay:t,coordinates:e,bounding:i,barSpace:n,precision:o,dateTimeFormat:r,defaultStyles:a,xAxis:s,yAxis:l}))&&void 0!==u?u:[]},i.prototype.drawDefaultFigures=function(t,e,i,n,o,r,a,s,l,c,u,h){var d,p,v=this;if(e.needDefaultPointFigure&&((null===(d=u.instance)||void 0===d?void 0:d.id)===e.id&&0!==u.figureType||(null===(p=h.instance)||void 0===p?void 0:p.id)===e.id&&0!==h.figureType)){var g=e.styles,f=E(E({},s.point),null==g?void 0:g.point);i.forEach((function(i,n){var o,r,a,s=i.x,l=i.y,c=f.radius,h=f.color,d=f.borderColor,p=f.borderSize;(null===(o=u.instance)||void 0===o?void 0:o.id)===e.id&&1===u.figureType&&u.figureIndex===n&&(c=f.activeRadius,h=f.activeColor,d=f.activeBorderColor,p=f.activeBorderSize),null===(r=v.createFigure("circle",{x:s,y:l,r:c+p},{color:d},v._createFigureEvents(e,1,n,0)))||void 0===r||r.draw(t),null===(a=v.createFigure("circle",{x:s,y:l,r:c},{color:h}))||void 0===a||a.draw(t)}))}},i}(Te),Fe=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._gridView=new Ie(n),n._indicatorView=new De(n),n._crosshairLineView=new Me(n),n._tooltipView=n.createTooltipView(),n._overlayView=new Ae(n),n.addChild(n._tooltipView),n.addChild(n._overlayView),n.getContainer().style.cursor="crosshair",n.registerEvent("mouseMoveEvent",(function(){return i.getChart().getChartStore().getTooltipStore().setActiveIconInfo(),!1})),n}return T(e,t),e.prototype.getName=function(){return Nt},e.prototype.updateMain=function(t){this.updateMainContent(t),this._indicatorView.draw(t),this._gridView.draw(t)},e.prototype.createTooltipView=function(){return new ke(this)},e.prototype.updateMainContent=function(t){},e.prototype.updateOverlay=function(t){this._overlayView.draw(t),this._crosshairLineView.draw(t),this._tooltipView.draw(t)},e}(ne),Le=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.drawImp=function(t){var e,i,o=this.getWidget(),r=o.getPane(),s=r.getChart(),l=r.getChart().getChartStore(),c=o.getBounding(),u=r.getAxisComponent(),h=l.getTimeScaleStore().getBarSpace(),d=s.getStyles().candle.area,p=[],v=[],g=Number.MAX_SAFE_INTEGER;this.eachChildren((function(t,e,i){var n=t.data,o=t.x,r=e.halfGapBar,s=n[d.value];if(a(s)){var l=u.convertToPixel(s);if(0===i){var h=o-r;v.push({x:h,y:c.height}),v.push({x:h,y:l}),p.push({x:h,y:l})}p.push({x:o,y:l}),v.push({x:o,y:l}),g=Math.min(g,l)}}));var f=v.length;if(f>0){var m=v[f-1],y=m.x+h.halfGapBar;p.push({x:y,y:m.y}),v.push({x:y,y:m.y}),v.push({x:y,y:c.height})}if(p.length>0&&(null===(e=this.createFigure("line",{coordinates:p},{color:d.lineColor,size:d.lineSize}))||void 0===e||e.draw(t)),v.length>0){var _=d.backgroundColor,x=void 0;if(n(_)){var S=t.createLinearGradient(0,c.height,0,g);try{_.forEach((function(t){var e=t.offset,i=t.color;S.addColorStop(e,i)}))}catch(t){}x=S}else x=_;null===(i=this.createFigure("polygon",{coordinates:v},{color:x}))||void 0===i||i.draw(t)}},e}(Ee),Re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.drawImp=function(t){var e=this.getWidget().getPane(),i=e.getChart().getChartStore(),n=i.getStyles().candle.priceMark,o=n.high,r=n.low;if(n.show&&(o.show||r.show)){var a=i.getPrecision(),s=e.getAxisComponent(),l=Number.MIN_SAFE_INTEGER,c=0,u=Number.MAX_SAFE_INTEGER,h=0;this.eachChildren((function(t){var e=t.data,i=t.x;l<e.high&&(l=e.high,c=i),u>e.low&&(u=e.low,h=i)}));var d=s.convertToPixel(l),p=s.convertToPixel(u);o.show&&l!==Number.MIN_SAFE_INTEGER&&this._drawMark(t,C(l,a.price),{x:c,y:d},d<p?[-2,-5]:[2,5],o),r.show&&u!==Number.MAX_SAFE_INTEGER&&this._drawMark(t,C(u,a.price),{x:h,y:p},d<p?[2,5]:[-2,-5],r)}},e.prototype._drawMark=function(t,e,i,n,o){var r,a,s,l,c,u,h=i.x,d=i.y+n[0];null===(r=this.createFigure("line",{coordinates:[{x:h-2,y:d+n[0]},{x:h,y:d},{x:h+2,y:d+n[0]}]},{color:o.color}))||void 0===r||r.draw(t),h>this.getWidget().getBounding().width/2?(c=(l=h-5)-o.textOffset,u="right"):(u="left",c=(l=h+5)+o.textOffset);var p=d+n[1];null===(a=this.createFigure("line",{coordinates:[{x:h,y:d},{x:h,y:p},{x:l,y:p}]},{color:o.color}))||void 0===a||a.draw(t),null===(s=this.createFigure("text",{x:c,y:p,text:e,align:u,baseline:"middle"},{color:o.color,size:o.textSize,family:o.textFamily,weight:o.textWeight}))||void 0===s||s.draw(t)},e}(Ee),Be=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.drawImp=function(t){var e,i=this.getWidget(),n=i.getPane(),o=i.getBounding(),r=n.getChart().getChartStore(),a=r.getStyles().candle.priceMark,s=a.last,l=s.line;if(a.show&&s.show&&l.show){var c=n.getAxisComponent(),u=r.getDataList(),h=u[u.length-1];if(null!=h){var d=h.close,p=h.open,v=c.convertToNicePixel(d),g=void 0;g=d>p?s.upColor:d<p?s.downColor:s.noChangeColor,null===(e=this.createFigure("line",{coordinates:[{x:0,y:v},{x:o.width,y:v}]},{style:l.style,color:g,size:l.size,dashedValue:l.dashedValue}))||void 0===e||e.draw(t)}}},e}(Te),Oe={"zh-CN":{time:"时间：",open:"开：",high:"高：",low:"低：",close:"收：",volume:"成交量："},"en-US":{time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: "}};function Ve(t,e){var i,n;return null!==(n=null===(i=Oe[e])||void 0===i?void 0:i[t])&&void 0!==n?n:t}var Ne=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return T(i,e),i.prototype.drawImp=function(e){var i,n=this.getWidget(),o=n.getPane(),r=o.getId(),a=o.getChart().getChartStore(),s=a.getCrosshairStore().get();if(void 0!==s.kLineData){var l=n.getBounding(),c=null===(i=o.getYAxisWidget())||void 0===i?void 0:i.getBounding(),u=a.getDataList(),h=a.getPrecision(),d=a.getLocale(),p=a.getCustomApi(),v=a.getTooltipStore().getActiveIconInfo(),g=a.getIndicatorStore().getInstances(o.getId()),f=a.getTimeScaleStore().getDateTimeFormat(),m=a.getStyles(),y=m.candle,_=m.indicator;if(y.tooltip.showType===t.TooltipShowType.Rect&&_.tooltip.showType===t.TooltipShowType.Rect){var x=this.isDrawTooltip(s,y.tooltip),S=this.isDrawTooltip(s,_.tooltip);this._drawRectTooltip(e,u,g,l,c,s,h,f,d,p,x,S,m,0)}else if(y.tooltip.showType===t.TooltipShowType.Standard&&_.tooltip.showType===t.TooltipShowType.Standard){var C=this._drawCandleStandardTooltip(e,u,r,l,s,v,h,f,d,p,y);this.drawIndicatorTooltip(e,r,u,s,v,g,p,l,_,C)}else if(y.tooltip.showType===t.TooltipShowType.Rect&&_.tooltip.showType===t.TooltipShowType.Standard){var b=this.drawIndicatorTooltip(e,r,u,s,v,g,p,l,_,0);x=this.isDrawTooltip(s,y.tooltip);this._drawRectTooltip(e,u,g,l,c,s,h,f,d,p,x,!1,m,b)}else{var w=this._drawCandleStandardTooltip(e,u,r,l,s,v,h,f,d,p,y);S=this.isDrawTooltip(s,_.tooltip);this._drawRectTooltip(e,u,g,l,c,s,h,f,d,p,!1,S,m,w)}}},i.prototype._drawCandleStandardTooltip=function(t,e,i,n,o,r,a,s,l,c,u){var h,d,p,v=u.tooltip,g=v.text,f=0;if(this.isDrawTooltip(o,v)){var m=null!==(h=o.dataIndex)&&void 0!==h?h:0,y=this._getCandleTooltipData({prev:null!==(d=e[m-1])&&void 0!==d?d:null,current:o.kLineData,next:null!==(p=e[m+1])&&void 0!==p?p:null},a,s,l,c,u),_=0,x=0,S=0,C=k(this.classifyTooltipIcons(v.icons),3),b=C[0],w=C[1],T=C[2],I=k(this.drawStandardTooltipIcons(t,n,{paneId:i,indicatorName:"",iconId:""},r,b,_,x,0),4),E=I[0],P=I[1],D=I[2];_=E,x=P,f+=I[3],S=D;var M=k(this.drawStandardTooltipIcons(t,n,{paneId:i,indicatorName:"",iconId:""},r,w,_,x,S),4),A=M[0],F=M[1],L=M[2];if(_=A,x=F,f+=M[3],S=L,y.length>0){var R=k(this.drawStandardTooltipLabels(t,n,y,_,x,S,g),4),B=R[0],O=R[1],V=R[2];_=B,x=O,f+=R[3],S=V}var N=k(this.drawStandardTooltipIcons(t,n,{paneId:i,indicatorName:"",iconId:""},r,T,_,x,S),4),W=N[0],z=N[1],Y=N[2];_=W,x=z,f+=N[3],S=Y}return f},i.prototype._drawRectTooltip=function(e,i,n,o,r,a,s,l,c,u,h,d,p,v){var g,f,m,y,_,x=this,S=p.candle,C=p.indicator,b=S.tooltip,w=C.tooltip;if(h||d){var T=null!==(g=a.dataIndex)&&void 0!==g?g:0,I=this._getCandleTooltipData({prev:null!==(f=i[T-1])&&void 0!==f?f:null,current:a.kLineData,next:null!==(m=i[T+1])&&void 0!==m?m:null},s,l,c,u,S),E=b.text,P=E.marginLeft,D=E.marginRight,M=E.marginTop,k=E.marginBottom,A=E.size,F=E.weight,L=E.family,R=b.rect,B=R.paddingLeft,O=R.paddingRight,V=R.paddingTop,W=R.paddingBottom,z=R.offsetLeft,Y=R.offsetRight,H=R.offsetTop,X=R.borderSize,j=R.borderRadius,G=R.borderColor,U=R.color,q=0,Z=0,K=0;h&&(e.font=N(A,F,L),I.forEach((function(t){var i=t.title,n=t.value,o="".concat(i.text).concat(n.text),r=e.measureText(o).width+P+D;q=Math.max(q,r)})),K+=(k+M+A)*I.length);var $=w.text,J=$.marginLeft,Q=$.marginRight,tt=$.marginTop,et=$.marginBottom,it=$.size,nt=$.weight,ot=$.family,rt=[];if(d&&(e.font=N(it,nt,ot),n.forEach((function(t){var n,o=null!==(n=x.getIndicatorTooltipData(i,a,t,u,C).values)&&void 0!==n?n:[];rt.push(o),o.forEach((function(t){var i=t.title,n=t.value,o="".concat(i.text).concat(n.text),r=e.measureText(o).width+J+Q;q=Math.max(q,r),K+=tt+et+it}))}))),0!==(Z+=q)&&0!==K){Z+=2*X+B+O,K+=2*X+V+W;var at,st=o.width/2;(null!==(y=a.realX)&&void 0!==y?y:0)<st?(at=o.width-Y-Z,p.yAxis.inside&&p.yAxis.position===t.YAxisPosition.Right&&(at-=r.width)):(at=z,p.yAxis.inside&&p.yAxis.position===t.YAxisPosition.Left&&(at+=r.width));var lt=v+H;null===(_=this.createFigure("rect",{x:at,y:lt,width:Z,height:K},{style:t.PolygonType.StrokeFill,color:U,borderColor:G,borderSize:X,borderRadius:j}))||void 0===_||_.draw(e);var ct=at+X+B+P,ut=lt+X+V;if(h&&I.forEach((function(t){var i,n;ut+=M;var o=t.title;null===(i=x.createFigure("text",{x:ct,y:ut,text:o.text},{color:o.color,size:A,family:L,weight:F}))||void 0===i||i.draw(e);var r=t.value;null===(n=x.createFigure("text",{x:at+Z-X-D-O,y:ut,text:r.text,align:"right"},{color:r.color,size:A,family:L,weight:F}))||void 0===n||n.draw(e),ut+=A+k})),d){var ht=at+X+B+J;rt.forEach((function(t){t.forEach((function(t){var i,n;ut+=tt;var o=t.title,r=t.value;null===(i=x.createFigure("text",{x:ht,y:ut,text:o.text},{color:o.color,size:it,family:ot,weight:nt}))||void 0===i||i.draw(e),null===(n=x.createFigure("text",{x:at+Z-X-Q-O,y:ut,text:r.text,align:"right"},{color:r.color,size:it,family:ot,weight:nt}))||void 0===n||n.draw(e),ut+=it+et}))}))}}}},i.prototype._getCandleTooltipData=function(e,i,n,a,s,l){var c,u,h,d=l.tooltip,p=d.text.color,v=[];if(o(d.custom)){(null!==(u=null===(c=d.custom)||void 0===c?void 0:c.call(d,e,l))&&void 0!==u?u:[]).forEach((function(t){var e=t.title,i=t.value,n={text:"",color:""};r(e)?n=e:(n.text=e,n.color=p),n.text=Ve(n.text,a);var o={text:"",color:""};r(i)?o=i:(o.text=i,o.color=p),v.push({title:n,value:o})}))}else{var g=i.price,f=i.volume,m=e.current;v=[{title:{text:Ve("time",a),color:p},value:{text:s.formatDate(n,m.timestamp,"YYYY-MM-DD HH:mm",t.FormatDateType.Tooltip),color:p}},{title:{text:Ve("open",a),color:p},value:{text:C(m.open,g),color:p}},{title:{text:Ve("high",a),color:p},value:{text:C(m.high,g),color:p}},{title:{text:Ve("low",a),color:p},value:{text:C(m.low,g),color:p}},{title:{text:Ve("close",a),color:p},value:{text:C(m.close,g),color:p}},{title:{text:Ve("volume",a),color:p},value:{text:s.formatBigNumber(C(null!==(h=m.volume)&&void 0!==h?h:d.defaultValue,f)),color:p}}]}return v},i}(ke),We=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n._candleBarView=new Pe(n),n._candleAreaView=new Le(n),n._candleHighLowPriceView=new Re(n),n._candleLastPriceLineView=new Be(n),n.addChild(n._candleBarView),n}return T(i,e),i.prototype.updateMainContent=function(e){this.getPane().getChart().getStyles().candle.type!==t.CandleType.Area?(this._candleBarView.draw(e),this._candleHighLowPriceView.draw(e),this._candleLastPriceLineView.draw(e)):this._candleAreaView.draw(e)},i.prototype.createTooltipView=function(){return new Ne(this)},i}(Fe),ze=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.drawImp=function(t){var e,i=this,n=this.getWidget(),o=n.getPane(),r=n.getBounding(),a=o.getAxisComponent(),s=this.getAxisStyles(o.getChart().getStyles());if(s.show){s.axisLine.show&&(null===(e=this.createFigure("line",this.createAxisLine(r,s),s.axisLine))||void 0===e||e.draw(t));var l=a.getTicks();if(s.tickLine.show)this.createTickLines(l,r,s).forEach((function(e){var n;null===(n=i.createFigure("line",e,s.tickLine))||void 0===n||n.draw(t)}));if(s.tickText.show)this.createTickTexts(l,r,s).forEach((function(e){var n;null===(n=i.createFigure("text",e,s.tickText))||void 0===n||n.draw(t)}))}},e}(Te),Ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.getAxisStyles=function(t){return t.yAxis},e.prototype.createAxisLine=function(t,e){var i,n=this.getWidget().getPane().getAxisComponent(),o=e.axisLine.size;return{coordinates:[{x:i=n.isFromZero()?o/2:t.width-o,y:0},{x:i,y:t.height}]}},e.prototype.createTickLines=function(t,e,i){var n=this.getWidget().getPane().getAxisComponent(),o=i.axisLine,r=i.tickLine,a=0,s=0;return n.isFromZero()?(a=0,o.show&&(a+=o.size),s=a+r.length):(a=e.width,o.show&&(a-=o.size),s=a-r.length),t.map((function(t){return{coordinates:[{x:a,y:t.coord},{x:s,y:t.coord}]}}))},e.prototype.createTickTexts=function(t,e,i){var n=this.getWidget().getPane().getAxisComponent(),o=i.axisLine,r=i.tickLine,a=i.tickText,s=0;n.isFromZero()?(s=a.marginStart,o.show&&(s+=o.size),r.show&&(s+=r.length)):(s=e.width-a.marginEnd,o.show&&(s-=o.size),r.show&&(s-=r.length));var l=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return t.map((function(t){return{x:s,y:t.coord,text:t.text,align:l,baseline:"middle"}}))},e}(ze),He=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return T(i,e),i.prototype.drawImp=function(e){var i,n=this.getWidget(),o=n.getPane(),r=n.getBounding(),a=o.getChart().getChartStore(),s=a.getStyles().candle.priceMark,l=s.last,c=l.text;if(s.show&&l.show&&c.show){var u=a.getPrecision(),h=o.getAxisComponent(),d=a.getDataList(),p=a.getVisibleDataList(),v=d[d.length-1];if(void 0!==v){var g=v.close,f=v.open,m=h.convertToNicePixel(g),y=void 0;y=g>f?l.upColor:g<f?l.downColor:l.noChangeColor;var _=void 0;if(h.getType()===t.YAxisType.Percentage){var x=p[0].data.close;_="".concat(((g-x)/x*100).toFixed(2),"%")}else _=C(g,u.price);var S=void 0,b=void 0;h.isFromZero()?(S=0,b="left"):(S=r.width,b="right"),null===(i=this.createFigure("rectText",{x:S,y:m,text:_,align:b,baseline:"middle"},E(E({},c),{backgroundColor:y})))||void 0===i||i.draw(e)}}},i}(Te),Xe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.drawImp=function(t){var e=this,i=this.getWidget(),n=i.getPane(),o=i.getBounding(),r=n.getChart().getChartStore(),a=r.getCustomApi(),l=r.getStyles().indicator,c=l.lastValueMark,u=c.text;if(c.show){var h=n.getAxisComponent(),d=r.getDataList(),p=d.length-1;r.getIndicatorStore().getInstances(n.getId()).forEach((function(i){var n=i.result[p];if(void 0!==n&&i.visible){var r=i.precision;K(d,i,p,l,(function(l,c){var d,p=n[l.key];if(s(p)){var v=h.convertToNicePixel(p),g=C(p,r);i.shouldFormatBigNumber&&(g=a.formatBigNumber(g));var f=void 0,m=void 0;h.isFromZero()?(f=0,m="left"):(f=o.width,m="right"),null===(d=e.createFigure("rectText",{x:f,y:v,text:g,align:m,baseline:"middle"},E(E({},u),{backgroundColor:c.color})))||void 0===d||d.draw(t)}}))}}))}},e}(Te),je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},e.prototype.drawDefaultFigures=function(t,e,i,n,o,r,a,s,l,c,u,h){this.drawFigures(t,e,this.getDefaultFigures(e,i,n,o,r,a,l,c,h),s)},e.prototype.getDefaultFigures=function(t,e,i,n,o,r,a,s,l){var c,u,h=[];if(t.needDefaultYAxisFigure&&t.id===(null===(c=l.instance)||void 0===c?void 0:c.id)&&l.paneId===this.getWidget().getPane().getId()){var d,p,v=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;null!==(u=null==s?void 0:s.isFromZero())&&void 0!==u&&u?(d="left",p=0):(d="right",p=i.width),e.forEach((function(e,i){var o=t.points[i];if(void 0!==o.value){v=Math.min(v,e.y),g=Math.max(g,e.y);var r=C(o.value,n.price);h.push({type:"rectText",attrs:{x:p,y:e.y,text:r,align:d,baseline:"middle"},ignoreEvent:!0})}})),e.length>1&&h.unshift({type:"rect",attrs:{x:0,y:v,width:i.width,height:g-v},ignoreEvent:!0})}return h},e.prototype.getFigures=function(t,e,i,n,o,r,a,s,l){var c,u;return null!==(u=null===(c=t.createYAxisFigures)||void 0===c?void 0:c.call(t,{overlay:t,coordinates:e,bounding:i,barSpace:n,precision:o,dateTimeFormat:r,defaultStyles:a,xAxis:s,yAxis:l}))&&void 0!==u?u:[]},e}(Ae),Ge=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return T(i,e),i.prototype.drawImp=function(t){var e,i=this.getWidget(),n=i.getPane(),o=i.getBounding(),r=i.getPane().getChart().getChartStore(),a=r.getCrosshairStore().get(),s=r.getStyles().crosshair;if(void 0!==a.paneId&&void 0!==a.kLineData&&this.checkPaneId(a,n.getId())&&s.show){var l=this.getDirectionStyles(s),c=l.text;if(l.show&&c.show){var u=n.getAxisComponent(),h=this.getText(a,r,u);t.font=N(c.size,c.weight,c.family),null===(e=this.createFigure("rectText",this.getTextAttrs(h,t.measureText(h).width,a,o,u,c),c))||void 0===e||e.draw(t)}}},i.prototype.checkPaneId=function(t,e){return t.paneId===e},i.prototype.getDirectionStyles=function(t){return t.horizontal},i.prototype.getText=function(e,i,n){var o,r,a,s=n,l=n.convertFromPixel(e.y);if(s.getType()===t.YAxisType.Percentage){var c=null!==(r=null===(o=i.getVisibleDataList()[0])||void 0===o?void 0:o.data)&&void 0!==r?r:{};a="".concat(((l-c.close)/c.close*100).toFixed(2),"%")}else{var u=i.getIndicatorStore().getInstances(e.paneId),h=0,d=!1;s.isInCandle()?h=i.getPrecision().price:u.forEach((function(t){h=Math.max(t.precision,h),d||(d=t.shouldFormatBigNumber)})),a=C(l,h),d&&(a=i.getCustomApi().formatBigNumber(a))}return a},i.prototype.getTextAttrs=function(t,e,i,n,o,r){var a,s;return o.isFromZero()?(a=0,s="left"):(a=n.width,s="right"),{x:a,y:i.y,text:t,align:s,baseline:"middle"}},i}(Te),Ue=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._yAxisView=new Ye(n),n._candleLastPriceLabelView=new He(n),n._indicatorLastValueView=new Xe(n),n._overlayYAxisView=new je(n),n._crosshairHorizontalLabelView=new Ge(n),n.getContainer().style.cursor="ns-resize",n.addChild(n._overlayYAxisView),n}return T(e,t),e.prototype.getName=function(){return zt},e.prototype.updateMain=function(t){this._yAxisView.draw(t),this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(t),this._indicatorLastValueView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayYAxisView.draw(t),this._crosshairHorizontalLabelView.draw(t)},e}(ne),qe=function(){function t(t){this._extremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._prevExtremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=t}return t.prototype.getParent=function(){return this._parent},t.prototype.buildTicks=function(t){return this._autoCalcTickFlag&&(this._extremum=this.calcExtremum()),!(this._prevExtremum.min===this._extremum.min&&this._prevExtremum.max===this._extremum.max&&!t)&&(this._prevExtremum=this._extremum,this._ticks=this.optimalTicks(this._calcTicks()),!0)},t.prototype.getTicks=function(){return this._ticks},t.prototype.setExtremum=function(t){this._autoCalcTickFlag=!1,this._extremum=t},t.prototype.getExtremum=function(){return this._extremum},t.prototype.setAutoCalcTickFlag=function(t){this._autoCalcTickFlag=t},t.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},t.prototype._calcTicks=function(){var t=this._extremum,e=t.realMin,i=t.realMax,n=t.realRange,o=[];if(n>=0){var r=k(this._calcTickInterval(n),2),a=r[0],s=r[1],l=Y(Math.ceil(e/a)*a,s),c=Y(Math.floor(i/a)*a,s),u=0,h=l;if(0!==a)for(;h<=c;){var d=h.toFixed(s);o[u]={text:d,coord:0,value:d},++u,h+=a}}return o},t.prototype._calcTickInterval=function(t){var e,i,n,o,r=(e=t/8,i=Math.floor(X(e)),n=j(i),e=((o=e/n)<1.5?1:o<2.5?2:o<3.5?3:o<4.5?4:o<5.5?5:o<6.5?6:8)*n,i>=-20?+e.toFixed(i<0?-i:0):e),a=function(t){var e=t.toString(),i=e.indexOf("e");if(i>0){var n=+e.slice(i+1);return n<0?-n:0}var o=e.indexOf(".");return o<0?0:e.length-1-o}(r);return[r,a]},t}(),Ze=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return T(i,e),i.prototype.calcExtremum=function(){var e,i,n,o,r,a=this.getParent(),l=a.getChart(),c=l.getChartStore(),u=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER,d=[],p=!1,v=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER,f=Number.MAX_SAFE_INTEGER;c.getIndicatorStore().getInstances(a.getId()).forEach((function(t){var e,i,n;p||(p=null!==(e=t.shouldOhlc)&&void 0!==e&&e),f=Math.min(f,t.precision),null!==t.minValue&&(v=Math.min(v,t.minValue)),null!==t.maxValue&&(g=Math.max(g,t.maxValue)),d.push({figures:null!==(i=t.figures)&&void 0!==i?i:[],result:null!==(n=t.result)&&void 0!==n?n:[]})}));var m=4,y=this.isInCandle();if(y){var _=c.getPrecision().price;m=f!==Number.MAX_SAFE_INTEGER?Math.min(f,_):_}else f!==Number.MAX_SAFE_INTEGER&&(m=f);var x=c.getVisibleDataList(),S=l.getStyles().candle,C=S.type===t.CandleType.Area,b=S.area.value,w=y&&!C||!y&&p;x.forEach((function(t){var e=t.dataIndex,i=t.data;w&&(u=Math.min(u,i.low),h=Math.max(h,i.high)),y&&C&&(u=Math.min(u,i[b]),h=Math.max(h,i[b])),d.forEach((function(t){var i,n=t.figures,o=null!==(i=t.result[e])&&void 0!==i?i:{};n.forEach((function(t){var e=o[t.key];s(e)&&(u=Math.min(u,e),h=Math.max(h,e))}))}))})),u!==Number.MAX_SAFE_INTEGER&&h!==Number.MIN_SAFE_INTEGER?(u=Math.min(v,u),h=Math.max(g,h)):(u=0,h=10);var T,I=this.getType();switch(I){case t.YAxisType.Percentage:var E=null===(e=x[0])||void 0===e?void 0:e.data;void 0!==(null==E?void 0:E.close)&&(u=(u-E.close)/E.close*100,h=(h-E.close)/E.close*100),T=Math.pow(10,-2);break;case t.YAxisType.Log:u=X(u),h=X(h),T=.05*j(-m);break;default:T=j(-m)}if(u===h||Math.abs(u-h)<T){var P=v===u,D=g===h;u=P?u:D?u-8*T:u-4*T,h=D?h:P?h+8*T:h+4*T}var M=null!==(n=null===(i=this.getParent().getYAxisWidget())||void 0===i?void 0:i.getBounding().height)&&void 0!==n?n:0,k=a.getOptions().gap,A=null!==(o=null==k?void 0:k.top)&&void 0!==o?o:.2;A>=1&&(A/=M);var F=null!==(r=null==k?void 0:k.bottom)&&void 0!==r?r:.1;F>=1&&(F/=M);var L,R,B,O=Math.abs(h-u);return u-=O*F,h+=O*A,O=Math.abs(h-u),I===t.YAxisType.Log?(L=j(u),R=j(h),B=Math.abs(R-L)):(L=u,R=h,B=O),{min:u,max:h,range:O,realMin:L,realMax:R,realRange:B}},i.prototype._innerConvertToPixel=function(t){var e,i,n=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,o=this.getExtremum(),r=(t-o.min)/o.range;return this.isReverse()?Math.round(r*n):Math.round((1-r)*n)},i.prototype.isInCandle=function(){return"candle"===this.getParent().getName()},i.prototype.getType=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.type:t.YAxisType.Normal},i.prototype.getPosition=function(){return this.getParent().getChart().getStyles().yAxis.position},i.prototype.isReverse=function(){return!!this.isInCandle()&&this.getParent().getChart().getStyles().yAxis.reverse},i.prototype.isFromZero=function(){var e=this.getParent().getChart().getStyles().yAxis,i=e.inside;return e.position===t.YAxisPosition.Left&&i||e.position===t.YAxisPosition.Right&&!i},i.prototype.optimalTicks=function(e){var i,n,o=this,r=this.getParent(),a=null!==(n=null===(i=r.getYAxisWidget())||void 0===i?void 0:i.getBounding().height)&&void 0!==n?n:0,s=r.getChart().getChartStore(),l=s.getCustomApi(),c=[],u=this.getType(),h=s.getIndicatorStore().getInstances(r.getId()),d=0,p=!1;this.isInCandle()?d=s.getPrecision().price:h.forEach((function(t){d=Math.max(d,t.precision),p||(p=t.shouldFormatBigNumber)}));var v,g=s.getStyles().xAxis.tickText.size;return e.forEach((function(e){var i,n=e.value,r=o._innerConvertToPixel(+n);switch(u){case t.YAxisType.Percentage:i="".concat(C(n,2),"%");break;case t.YAxisType.Log:r=o._innerConvertToPixel(X(+n)),i=C(n,d);break;default:i=C(n,d),p&&(i=l.formatBigNumber(n))}r>g&&r<a-g&&(void 0!==v&&Math.abs(v-r)>2*g||void 0===v)&&(c.push({text:i,coord:r,value:n}),v=r)})),c},i.prototype.getAutoSize=function(){var e=this.getParent(),i=e.getChart(),n=i.getStyles(),o=n.yAxis,r=o.size;if("auto"!==r)return r;var a=i.getChartStore(),s=a.getCustomApi(),l=0;if(o.show&&(o.axisLine.show&&(l+=o.axisLine.size),o.tickLine.show&&(l+=o.tickLine.length),o.tickText.show)){var c=0;this.getTicks().forEach((function(t){c=Math.max(c,W(t.text,o.tickText.size,o.tickText.weight,o.tickText.family))})),l+=o.tickText.marginStart+o.tickText.marginEnd+c}var u=n.crosshair,h=0;if(u.show&&u.horizontal.show&&u.horizontal.text.show){var d=a.getIndicatorStore().getInstances(e.getId()),p=0,v=!1;d.forEach((function(t){p=Math.max(t.precision,p),v||(v=t.shouldFormatBigNumber)}));var g=2;if(this.getType()!==t.YAxisType.Percentage)if(this.isInCandle()){var f=a.getPrecision().price,m=n.indicator.lastValueMark;g=m.show&&m.text.show?Math.max(p,f):f}else g=p;var y=C(this.getExtremum().max,g);v&&(y=s.formatBigNumber(y)),h+=u.horizontal.text.paddingLeft+u.horizontal.text.paddingRight+2*u.horizontal.text.borderSize+W(y,u.horizontal.text.size,u.horizontal.text.weight,u.horizontal.text.family)}return Math.max(l,h)},i.prototype.convertFromPixel=function(e){var i,n,o,r=null!==(n=null===(i=this.getParent().getYAxisWidget())||void 0===i?void 0:i.getBounding().height)&&void 0!==n?n:0,a=this.getExtremum(),s=a.min,l=a.range,c=(this.isReverse()?e/r:1-e/r)*l+s;switch(this.getType()){case t.YAxisType.Percentage:var u=null===(o=this.getParent().getChart().getChartStore().getVisibleDataList()[0])||void 0===o?void 0:o.data;return void 0!==(null==u?void 0:u.close)?u.close*c/100+u.close:0;case t.YAxisType.Log:return j(c);default:return c}},i.prototype.convertToRealValue=function(e){var i=e;return this.getType()===t.YAxisType.Log&&(i=j(e)),i},i.prototype.convertToPixel=function(e){var i,n=e;switch(this.getType()){case t.YAxisType.Percentage:var o=null===(i=this.getParent().getChart().getChartStore().getVisibleDataList()[0])||void 0===i?void 0:i.data;void 0!==(null==o?void 0:o.close)&&(n=(e-o.close)/o.close*100);break;case t.YAxisType.Log:n=X(e);break;default:n=e}return this._innerConvertToPixel(n)},i.prototype.convertToNicePixel=function(t){var e,i,n=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,o=this.convertToPixel(t);return Math.round(Math.max(.05*n,Math.min(o,.98*n)))},i}(qe),Ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.getName=function(){return"indicator"},e.prototype.createAxisComponent=function(){return new Ze(this)},e.prototype.createMainWidget=function(t){return new Fe(t,this)},e.prototype.createSeparatorWidget=function(t){return new Xt(t,this)},e.prototype.creatYAxisWidget=function(t){return new Ue(t,this)},e}(qt),$e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.getName=function(){return"candle"},e.prototype.createMainWidget=function(t){return new We(t,this)},e.prototype.createSeparatorWidget=function(){return null},e}(Ke),Je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.getAxisStyles=function(t){return t.xAxis},e.prototype.createAxisLine=function(t,e){var i=e.axisLine.size/2;return{coordinates:[{x:0,y:i},{x:t.width,y:i}]}},e.prototype.createTickLines=function(t,e,i){var n=i.tickLine,o=i.axisLine.size;return t.map((function(t){return{coordinates:[{x:t.coord,y:0},{x:t.coord,y:o+n.length}]}}))},e.prototype.createTickTexts=function(t,e,i){var n=i.tickText,o=i.axisLine.size,r=i.tickLine.length;return t.map((function(t){return{x:t.coord,y:o+r+n.marginStart,text:t.text,align:"center",baseline:"top"}}))},e}(ze),Qe=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return T(i,e),i.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},i.prototype.coordinateToPointValueFlag=function(){return!1},i.prototype.getCompleteOverlays=function(t){return t.getInstances()},i.prototype.getProgressOverlay=function(t){return t.instance},i.prototype.getDefaultFigures=function(e,i,n,o,r,a,s,l,c){var u,h=[];if(e.needDefaultXAxisFigure&&e.id===(null===(u=c.instance)||void 0===u?void 0:u.id)){var d=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER;i.forEach((function(i,n){d=Math.min(d,i.x),p=Math.max(p,i.x);var o=e.points[n];if(void 0!==o.timestamp){var s=a.formatDate(r,o.timestamp,"YYYY-MM-DD HH:mm",t.FormatDateType.Crosshair);h.push({type:"rectText",attrs:{x:i.x,y:0,text:s,align:"center"},ignoreEvent:!0})}})),i.length>1&&h.unshift({type:"rect",attrs:{x:d,y:0,width:p-d,height:n.height},ignoreEvent:!0})}return h},i.prototype.getFigures=function(t,e,i,n,o,r,a,s,l){var c,u;return null!==(u=null===(c=t.createXAxisFigures)||void 0===c?void 0:c.call(t,{overlay:t,coordinates:e,bounding:i,barSpace:n,precision:o,dateTimeFormat:r,defaultStyles:a,xAxis:s,yAxis:l}))&&void 0!==u?u:[]},i}(je),ti=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return T(i,e),i.prototype.checkPaneId=function(t){return t.dataIndex===t.realDataIndex},i.prototype.getDirectionStyles=function(t){return t.vertical},i.prototype.getText=function(e,i){var n,o=null===(n=e.kLineData)||void 0===n?void 0:n.timestamp;return i.getCustomApi().formatDate(i.getTimeScaleStore().getDateTimeFormat(),o,"YYYY-MM-DD HH:mm",t.FormatDateType.Crosshair)},i.prototype.getTextAttrs=function(t,e,i,n,o,r){var a=i.realX;return{x:a-e/2-r.paddingLeft<0?r.paddingLeft+e/2:a+e/2+r.paddingRight>n.width?n.width-r.paddingRight-e/2:a,y:0,text:t,align:"center",baseline:"top"}},i}(Ge),ei=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._xAxisView=new Je(n),n._overlayXAxisView=new Qe(n),n._crosshairVerticalLabelView=new ti(n),n.getContainer().style.cursor="ew-resize",n.addChild(n._overlayXAxisView),n}return T(e,t),e.prototype.getName=function(){return Wt},e.prototype.updateMain=function(t){this._xAxisView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayXAxisView.draw(t),this._crosshairVerticalLabelView.draw(t)},e}(ne),ii=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return T(i,e),i.prototype.calcExtremum=function(){var t=this.getParent().getChart().getChartStore().getTimeScaleStore().getVisibleRange(),e=t.from,i=t.to,n=i-1,o=i-e;return{min:e,max:n,range:o,realMin:e,realMax:n,realRange:o}},i.prototype.optimalTicks=function(e){var i,n,o=this.getParent().getChart(),r=o.getChartStore(),a=r.getCustomApi().formatDate,s=[],l=e.length,c=r.getDataList();if(l>0){var u=r.getTimeScaleStore().getDateTimeFormat(),h=o.getStyles().xAxis.tickText,d=W("00-00 00:00",h.size,h.weight,h.family),p=parseInt(e[0].value,10),v=this.convertToPixel(p),g=1;if(l>1){var f=parseInt(e[1].value,10),m=this.convertToPixel(f),y=Math.abs(m-v);y<d&&(g=Math.ceil(d/y))}for(var _=0;_<l;_+=g){var x=parseInt(e[_].value,10),S=c[x].timestamp,C=a(u,S,"HH:mm",t.FormatDateType.XAxis);if(0!==_){var b=c[parseInt(e[_-g].value,10)].timestamp;C=null!==(i=this._optimalTickLabel(a,u,S,b))&&void 0!==i?i:C}var w=this.convertToPixel(x);s.push({text:C,coord:w,value:S})}if(1===s.length)s[0].text=a(u,s[0].value,"YYYY-MM-DD HH:mm",t.FormatDateType.XAxis);else{var T=s[0].value,I=s[1].value;if(void 0!==s[2]){var E=s[2].text;/^[0-9]{2}-[0-9]{2}$/.test(E)?s[0].text=a(u,T,"MM-DD",t.FormatDateType.XAxis):/^[0-9]{4}-[0-9]{2}$/.test(E)?s[0].text=a(u,T,"YYYY-MM",t.FormatDateType.XAxis):/^[0-9]{4}$/.test(E)&&(s[0].text=a(u,T,"YYYY",t.FormatDateType.XAxis))}else s[0].text=null!==(n=this._optimalTickLabel(a,u,T,I))&&void 0!==n?n:s[0].text}}return s},i.prototype._optimalTickLabel=function(e,i,n,o){var r=e(i,n,"YYYY",t.FormatDateType.XAxis),a=e(i,n,"YYYY-MM",t.FormatDateType.XAxis),s=e(i,n,"MM-DD",t.FormatDateType.XAxis);return r!==e(i,o,"YYYY",t.FormatDateType.XAxis)?r:a!==e(i,o,"YYYY-MM",t.FormatDateType.XAxis)?a:s!==e(i,o,"MM-DD",t.FormatDateType.XAxis)?s:null},i.prototype.getAutoSize=function(){var t=this.getParent().getChart().getStyles(),e=t.xAxis,i=e.size;if("auto"!==i)return i;var n=t.crosshair,o=0;e.show&&(e.axisLine.show&&(o+=e.axisLine.size),e.tickLine.show&&(o+=e.tickLine.length),e.tickText.show&&(o+=e.tickText.marginStart+e.tickText.marginEnd+e.tickText.size));var r=0;return n.show&&n.vertical.show&&n.vertical.text.show&&(r+=n.vertical.text.paddingTop+n.vertical.text.paddingBottom+2*n.vertical.text.borderSize+n.vertical.text.size),Math.max(o,r)},i.prototype.convertFromPixel=function(t){return this.getParent().getChart().getChartStore().getTimeScaleStore().coordinateToDataIndex(t)},i.prototype.convertToPixel=function(t){return this.getParent().getChart().getChartStore().getTimeScaleStore().dataIndexToCoordinate(t)},i}(qe),ni=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return T(e,t),e.prototype.getName=function(){return"xAxis"},e.prototype.createAxisComponent=function(){return new ii(this)},e.prototype.createMainWidget=function(t){return new ei(t,this)},e}(qt);function oi(){var t;return"undefined"!=typeof window&&(null!==(t=window.navigator.userAgent.toLowerCase().indexOf("firefox"))&&void 0!==t?t:-1)>-1}function ri(){return"undefined"!=typeof window&&/iPhone|iPad|iPod/.test(window.navigator.platform)}var ai,si=function(){function t(t,e,i){var n=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!ri(),this._onFirefoxOutsideMouseUp=function(t){n._mouseUpHandler(t)},this._onMobileSafariDoubleClick=function(t){n._firesTouchEvents(t)?(++n._tapCount,null!==n._tapTimeoutId&&n._tapCount>1&&(n._mouseTouchMoveWithDownInfo(n._getCoordinate(t),n._tapCoordinate).manhattanDistance<30&&!n._cancelTap&&n._processEvent(n._makeCompatEvent(t),n._handler.doubleTapEvent),n._resetTapTimeout())):(++n._clickCount,null!==n._clickTimeoutId&&n._clickCount>1&&(n._mouseTouchMoveWithDownInfo(n._getCoordinate(t),n._clickCoordinate).manhattanDistance<5&&!n._cancelClick&&n._processEvent(n._makeCompatEvent(t),n._handler.mouseDoubleClickEvent),n._resetClickTimeout()))},this._target=t,this._handler=e,this._options=i,this._init()}return t.prototype.destroy=function(){null!==this._unsubscribeOutsideMouseEvents&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),null!==this._unsubscribeOutsideTouchEvents&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeMouseWheel&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),null!==this._unsubscribeContextMenu&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),null!==this._unsubscribeMobileSafariEvents&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},t.prototype._mouseEnterHandler=function(t){var e,i,n,o=this;null===(e=this._unsubscribeMousemove)||void 0===e||e.call(this),null===(i=this._unsubscribeMouseWheel)||void 0===i||i.call(this),null===(n=this._unsubscribeContextMenu)||void 0===n||n.call(this);var r=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){o._target.removeEventListener("mousemove",r)},this._target.addEventListener("mousemove",r);var a=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){o._target.removeEventListener("wheel",a)},this._target.addEventListener("wheel",a,{passive:!1});var s=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){o._target.removeEventListener("contextmenu",s)},this._target.addEventListener("contextmenu",s,{passive:!1}),this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},t.prototype._resetClickTimeout=function(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},t.prototype._resetTapTimeout=function(){null!==this._tapTimeoutId&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},t.prototype._mouseMoveHandler=function(t){this._mousePressed||null!==this._touchMoveStartCoordinate||this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},t.prototype._mouseWheelHandler=function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(void 0===this._handler.mouseWheelHortEvent)return;if(this._preventDefault(t),0===Math.abs(t.deltaX))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(t),-t.deltaX)}else{if(void 0===this._handler.mouseWheelVertEvent)return;var e=-t.deltaY/100;if(0===e)return;switch(this._preventDefault(t),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32}if(0!==e){var i=Math.sign(e)*Math.min(1,Math.abs(e));this._handler.mouseWheelVertEvent(this._makeCompatEvent(t),i)}}},t.prototype._contextMenuHandler=function(t){this._preventDefault(t)},t.prototype._touchMoveHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(null!==e&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(t),null===this._startPinchMiddleCoordinate&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var i=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._touchMoveStartCoordinate),n=i.xOffset,o=i.yOffset,r=i.manhattanDistance;if(this._touchMoveExceededManhattanDistance||!(r<5)){if(!this._touchMoveExceededManhattanDistance){var a=.5*n,s=o>=a&&!this._options.treatVertDragAsPageScroll(),l=a>o&&!this._options.treatHorzDragAsPageScroll();s||l||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(t,e),this._handler.touchMoveEvent)}}},t.prototype._mouseMoveWithDownHandler=function(t){0===t.button&&(this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._mouseMoveStartCoordinate).manhattanDistance>=5&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(t),this._handler.pressedMouseMoveEvent))},t.prototype._mouseTouchMoveWithDownInfo=function(t,e){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return{xOffset:i,yOffset:n,manhattanDistance:i+n}},t.prototype._touchEndHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(null===e&&0===t.touches.length&&(e=t.changedTouches[0]),null!==e){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var i=this._makeCompatEvent(t,e);if(this._processEvent(i,this._handler.touchEndEvent),++this._tapCount,null!==this._tapTimeoutId&&this._tapCount>1)this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate).manhattanDistance<30&&!this._cancelTap&&this._processEvent(i,this._handler.doubleTapEvent),this._resetTapTimeout();else this._cancelTap||(this._processEvent(i,this._handler.tapEvent),void 0!==this._handler.tapEvent&&this._preventDefault(t));0===this._tapCount&&this._preventDefault(t),0===t.touches.length&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(t))}},t.prototype._mouseUpHandler=function(t){if(0===t.button){var e=this._makeCompatEvent(t);if(this._mouseMoveStartCoordinate=null,this._mousePressed=!1,null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),oi())this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp);if(!this._firesTouchEvents(t))if(this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,null!==this._clickTimeoutId&&this._clickCount>1)this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._clickCoordinate).manhattanDistance<5&&!this._cancelClick&&this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout();else this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent)}},t.prototype._clearLongTapTimeout=function(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},t.prototype._touchStartHandler=function(t){if(null===this._activeTouchId){var e=t.changedTouches[0];this._activeTouchId=e.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(t);var i=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(e),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var n=this._touchMoveHandler.bind(this),o=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){i.removeEventListener("touchmove",n),i.removeEventListener("touchend",o)},i.addEventListener("touchmove",n,{passive:!1}),i.addEventListener("touchend",o,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),500),this._processEvent(this._makeCompatEvent(t,e),this._handler.touchStartEvent),null===this._tapTimeoutId&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(e))}},t.prototype._mouseDownHandler=function(t){if(2===t.button)return this._preventDefault(t),void this._processEvent(this._makeCompatEvent(t),this._handler.mouseRightClickEvent);if(0===t.button){var e=this._target.ownerDocument.documentElement;oi()&&e.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(t),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);var i=this._mouseMoveWithDownHandler.bind(this),n=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){e.removeEventListener("mousemove",i),e.removeEventListener("mouseup",n)},e.addEventListener("mousemove",i),e.addEventListener("mouseup",n),this._mousePressed=!0,this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseDownEvent),null===this._clickTimeoutId&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(t)))}},t.prototype._init=function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var e=this._target.ownerDocument,i=function(e){null!=t._handler.mouseDownOutsideEvent&&(e.composed&&t._target.contains(e.composedPath()[0])||null!==e.target&&t._target.contains(e.target)||t._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){e.removeEventListener("touchstart",i)},this._unsubscribeOutsideMouseEvents=function(){e.removeEventListener("mousedown",i)},e.addEventListener("mousedown",i),e.addEventListener("touchstart",i,{passive:!0}),ri()&&(this._unsubscribeMobileSafariEvents=function(){t._target.removeEventListener("dblclick",t._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",(function(t){if(1===t.button)return t.preventDefault(),!1})),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",(function(){}),{passive:!1})},t.prototype._initPinch=function(){var t=this;void 0===this._handler.pinchStartEvent&&void 0===this._handler.pinchEvent&&void 0===this._handler.pinchEndEvent||(this._target.addEventListener("touchstart",(function(e){return t._checkPinchState(e.touches)}),{passive:!0}),this._target.addEventListener("touchmove",(function(e){if(2===e.touches.length&&null!==t._startPinchMiddleCoordinate&&void 0!==t._handler.pinchEvent){var i=t._getTouchDistance(e.touches[0],e.touches[1])/t._startPinchDistance;t._handler.pinchEvent(E(E({},t._startPinchMiddleCoordinate),{pageX:0,pageY:0}),i),t._preventDefault(e)}}),{passive:!1}),this._target.addEventListener("touchend",(function(e){t._checkPinchState(e.touches)})))},t.prototype._checkPinchState=function(t){1===t.length&&(this._pinchPrevented=!1),2!==t.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)},t.prototype._startPinch=function(t){var e,i=null!==(e=this._target.getBoundingClientRect())&&void 0!==e?e:{left:0,top:0};this._startPinchMiddleCoordinate={x:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,y:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this._startPinchDistance=this._getTouchDistance(t[0],t[1]),void 0!==this._handler.pinchStartEvent&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},t.prototype._stopPinch=function(){null!==this._startPinchMiddleCoordinate&&(this._startPinchMiddleCoordinate=null,void 0!==this._handler.pinchEndEvent&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},t.prototype._mouseLeaveHandler=function(t){var e,i,n;null===(e=this._unsubscribeMousemove)||void 0===e||e.call(this),null===(i=this._unsubscribeMouseWheel)||void 0===i||i.call(this),null===(n=this._unsubscribeContextMenu)||void 0===n||n.call(this),this._firesTouchEvents(t)||this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!ri())},t.prototype._longTapHandler=function(t){var e=this._touchWithId(t.touches,this._activeTouchId);null!==e&&(this._processEvent(this._makeCompatEvent(t,e),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},t.prototype._firesTouchEvents=function(t){var e;return void 0!==(null===(e=t.sourceCapabilities)||void 0===e?void 0:e.firesTouchEvents)?t.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(t)<this._lastTouchEventTimeStamp+500},t.prototype._processEvent=function(t,e){null==e||e.call(this._handler,t)},t.prototype._makeCompatEvent=function(t,e){var i,n=this,o=null!=e?e:t,r=null!==(i=this._target.getBoundingClientRect())&&void 0!==i?i:{left:0,top:0};return{x:o.clientX-r.left,y:o.clientY-r.top,pageX:o.pageX,pageY:o.pageY,isTouch:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,preventDefault:function(){"touchstart"!==t.type&&n._preventDefault(t)}}},t.prototype._getTouchDistance=function(t,e){var i=t.clientX-e.clientX,n=t.clientY-e.clientY;return Math.sqrt(i*i+n*n)},t.prototype._preventDefault=function(t){t.cancelable&&t.preventDefault()},t.prototype._getCoordinate=function(t){return{x:t.pageX,y:t.pageY}},t.prototype._eventTimeStamp=function(t){var e;return null!==(e=t.timeStamp)&&void 0!==e?e:performance.now()},t.prototype._touchWithId=function(t,e){for(var i=0;i<t.length;++i)if(t[i].identifier===e)return t[i];return null},t}(),li=function(){function t(t,e){var i=this;this._flingStartTime=(new Date).getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(t){if(t.shiftKey)switch(t.code){case"Equal":i._chart.getChartStore().getTimeScaleStore().zoom(.5);break;case"Minus":i._chart.getChartStore().getTimeScaleStore().zoom(-.5);break;case"ArrowLeft":(e=i._chart.getChartStore().getTimeScaleStore()).startScroll(),e.scroll(-3*e.getBarSpace().bar);break;case"ArrowRight":var e;(e=i._chart.getChartStore().getTimeScaleStore()).startScroll(),e.scroll(3*e.getBarSpace().bar)}},this._container=t,this._chart=e,this._event=new si(t,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),t.addEventListener("keydown",this._boundKeyBoardDownEvent)}return t.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},t.prototype.pinchEvent=function(t,e){var i=this._findWidgetByEvent(t),n=i.pane,o=i.widget;if((null==n?void 0:n.getId())!==Ut&&(null==o?void 0:o.getName())===Nt){var r=this._makeWidgetEvent(t,o),a=5*(e-this._pinchScale);return this._pinchScale=e,this._chart.getChartStore().getTimeScaleStore().zoom(a,{x:r.x,y:r.y}),!0}return!1},t.prototype.mouseWheelHortEvent=function(t,e){var i=this._chart.getChartStore().getTimeScaleStore();return i.startScroll(),i.scroll(e),!0},t.prototype.mouseWheelVertEvent=function(t,e){var i,n,o=this._findWidgetByEvent(t).widget,r=null!==(i=t.isTouch)&&void 0!==i&&i,a=this._makeWidgetEvent(t,o),s=null,l=null==o?void 0:o.getName();if(r)if(l===Nt||l===Wt)s={x:a.x,y:a.y};else{var c=null===(n=this._chart.getPaneById(jt))||void 0===n?void 0:n.getBounding();s={x:c.width/2,y:c.height/2}}else l===Nt&&(s={x:a.x,y:a.y});return null!==s&&(this._chart.getChartStore().getTimeScaleStore().zoom(e,{x:a.x,y:a.y}),!0)},t.prototype.mouseDownEvent=function(t){var e,i,n=this._findWidgetByEvent(t),o=n.pane,r=n.widget;if(this._mouseDownWidget=r,null!==r){var a=this._makeWidgetEvent(t,r);switch(r.getName()){case Yt:return r.dispatchEvent("mouseDownEvent",a);case Nt:var s=null!==(e=null==o?void 0:o.getAxisComponent().getExtremum())&&void 0!==e?e:null;return this._prevYAxisExtremum=null===s?s:E({},s),this._startScrollCoordinate={x:a.x,y:a.y},this._chart.getChartStore().getTimeScaleStore().startScroll(),r.dispatchEvent("mouseDownEvent",a);case Wt:return(l=r.dispatchEvent("mouseDownEvent",a))&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:a.x,y:a.y},this._xAxisStartScaleDistance=a.pageX,l;case zt:var l;(l=r.dispatchEvent("mouseDownEvent",a))&&this._chart.updatePane(1);s=null!==(i=null==o?void 0:o.getAxisComponent().getExtremum())&&void 0!==i?i:null;return this._prevYAxisExtremum=null===s?s:E({},s),this._yAxisStartScaleDistance=a.pageY,l}}return!1},t.prototype.mouseMoveEvent=function(t){var e,i,n,o=this._findWidgetByEvent(t),r=o.pane,a=o.widget,s=this._makeWidgetEvent(t,a);if((null===(e=this._mouseMoveTriggerWidgetInfo.pane)||void 0===e?void 0:e.getId())===(null==r?void 0:r.getId())&&(null===(i=this._mouseMoveTriggerWidgetInfo.widget)||void 0===i?void 0:i.getName())===(null==a?void 0:a.getName())||(null==a||a.dispatchEvent("mouseEnterEvent",s),null===(n=this._mouseMoveTriggerWidgetInfo.widget)||void 0===n||n.dispatchEvent("mouseLeaveEvent",s),this._mouseMoveTriggerWidgetInfo={pane:r,widget:a}),null!==a)switch(a.getName()){case Nt:var l=a.dispatchEvent("mouseMoveEvent",s),c=this._chart.getChartStore(),u={x:s.x,y:s.y,paneId:null==r?void 0:r.getId()};return l&&null!==c.getTooltipStore().getActiveIconInfo()&&(u=void 0,null!==a&&(a.getContainer().style.cursor="pointer")),this._chart.getChartStore().getCrosshairStore().set(u),l;case Yt:case Wt:case zt:l=a.dispatchEvent("mouseMoveEvent",s);return this._chart.getChartStore().getCrosshairStore().set(),l}return!1},t.prototype.pressedMouseMoveEvent=function(t){var e,i,n,o;if(null!==this._mouseDownWidget&&this._mouseDownWidget.getName()===Yt)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",t);var r=this._findWidgetByEvent(t),a=r.pane,s=r.widget;if(null!==s&&(null===(e=this._mouseDownWidget)||void 0===e?void 0:e.getPane().getId())===(null==a?void 0:a.getId())&&(null===(i=this._mouseDownWidget)||void 0===i?void 0:i.getName())===s.getName()){var l=this._makeWidgetEvent(t,s);switch(s.getName()){case Nt:var c=s.getBounding();if(!(x=s.dispatchEvent("pressedMouseMoveEvent",l))&&null!==this._startScrollCoordinate){var u=null==a?void 0:a.getAxisComponent();if(null!==this._prevYAxisExtremum&&!u.getAutoCalcTickFlag()){var h=this._prevYAxisExtremum,d=h.min,p=h.max,v=d+(b=(S=h.range)*(C=(null!==(n=null==u?void 0:u.isReverse())&&void 0!==n&&n?this._startScrollCoordinate.y-l.y:l.y-this._startScrollCoordinate.y)/c.height)),g=p+b,f=u.convertToRealValue(v),m=u.convertToRealValue(g);u.setExtremum({min:v,max:g,range:g-v,realMin:f,realMax:m,realRange:m-f})}var y=l.x-this._startScrollCoordinate.x;this._chart.getChartStore().getTimeScaleStore().scroll(y)}return this._chart.getChartStore().getCrosshairStore().set({x:l.x,y:l.y,paneId:null==a?void 0:a.getId()}),x;case Wt:if(x=s.dispatchEvent("pressedMouseMoveEvent",l))this._chart.updatePane(1);else{var _=10*((C=this._xAxisStartScaleDistance/l.pageX)-this._xAxisScale);this._xAxisScale=C,this._chart.getChartStore().getTimeScaleStore().zoom(_,null!==(o=this._xAxisStartScaleCoordinate)&&void 0!==o?o:void 0)}return x;case zt:var x;if(x=s.dispatchEvent("pressedMouseMoveEvent",l))this._chart.updatePane(1);else if(null!==this._prevYAxisExtremum){var S,C,b,w=this._prevYAxisExtremum,T=(d=w.min,p=w.max,(S=w.range)*(C=l.pageY/this._yAxisStartScaleDistance));v=d-(b=(T-S)/2),g=p+b,f=(u=null==a?void 0:a.getAxisComponent()).convertToRealValue(v),m=u.convertToRealValue(g);u.setExtremum({min:v,max:g,range:T,realMin:f,realMax:m,realRange:m-f}),this._chart.adjustPaneViewport(!1,!0,!0,!0)}return x}}return!1},t.prototype.mouseUpEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(null!==e){var n=this._makeWidgetEvent(t,e);switch(e.getName()){case Nt:case Yt:case Wt:case zt:i=e.dispatchEvent("mouseUpEvent",n)}i&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,i},t.prototype.mouseClickEvent=function(t){var e=this._findWidgetByEvent(t).widget;if(null!==e){var i=this._makeWidgetEvent(t,e);return e.dispatchEvent("mouseClickEvent",i)}return!1},t.prototype.mouseRightClickEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(null!==e){var n=this._makeWidgetEvent(t,e);switch(e.getName()){case Nt:case Wt:case zt:i=e.dispatchEvent("mouseRightClickEvent",n)}i&&this._chart.updatePane(1)}return!1},t.prototype.mouseDoubleClickEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n)switch(n.getName()){case Nt:var o=this._makeWidgetEvent(t,n);return n.dispatchEvent("mouseDoubleClickEvent",o);case zt:var r=null==i?void 0:i.getAxisComponent();if(!r.getAutoCalcTickFlag())return r.setAutoCalcTickFlag(!0),this._chart.adjustPaneViewport(!1,!0,!0,!0),!0}return!1},t.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().getCrosshairStore().set(),!0},t.prototype.touchStartEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n){var o=this._makeWidgetEvent(t,n);switch(n.getName()){case Nt:var r=this._chart.getChartStore(),a=r.getCrosshairStore();if(n.dispatchEvent("mouseDownEvent",o))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,a.set(void 0,!0),this._chart.updatePane(1),!0;if(null!==this._flingScrollRequestId&&(clearTimeout(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=(new Date).getTime(),this._startScrollCoordinate={x:o.x,y:o.y},r.getTimeScaleStore().startScroll(),this._touchZoomed=!1,null!==this._touchCoordinate){var s=o.x-this._touchCoordinate.x,l=o.y-this._touchCoordinate.y;Math.sqrt(s*s+l*l)<10?(this._touchCoordinate={x:o.x,y:o.y},a.set({x:o.x,y:o.y,paneId:null==i?void 0:i.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,a.set())}return!0;case Wt:case zt:var c=n.dispatchEvent("mouseDownEvent",o);return c&&this._chart.updatePane(1),c}}return!1},t.prototype.touchMoveEvent=function(t){var e,i,n,o=this._findWidgetByEvent(t),r=o.pane,a=o.widget;if(null!==a){var s=this._makeWidgetEvent(t,a),l=a.getName(),c=this._chart.getChartStore(),u=c.getCrosshairStore();switch(l){case Nt:if(a.dispatchEvent("pressedMouseMoveEvent",s))return null===(e=s.preventDefault)||void 0===e||e.call(s),u.set(void 0,!0),this._chart.updatePane(1),!0;if(null!==this._touchCoordinate)null===(i=s.preventDefault)||void 0===i||i.call(s),u.set({x:s.x,y:s.y,paneId:null==r?void 0:r.getId()});else if(null!==this._startScrollCoordinate&&Math.abs(this._startScrollCoordinate.x-s.x)>this._startScrollCoordinate.y-s.y){var h=s.x-this._startScrollCoordinate.x;c.getTimeScaleStore().scroll(h)}return!0;case Wt:case zt:var d=a.dispatchEvent("pressedMouseMoveEvent",s);return d&&(null===(n=s.preventDefault)||void 0===n||n.call(s),this._chart.updatePane(1)),d}}return!1},t.prototype.touchEndEvent=function(t){var e=this,i=this._findWidgetByEvent(t).widget;if(null!==i){var n=this._makeWidgetEvent(t,i);switch(i.getName()){case Nt:if(i.dispatchEvent("mouseUpEvent",n),null!==this._startScrollCoordinate){var o=(new Date).getTime()-this._flingStartTime,r=(n.x-this._startScrollCoordinate.x)/(o>0?o:1)*20;if(o<200&&Math.abs(r)>0){var a=this._chart.getChartStore().getTimeScaleStore(),s=function(){e._flingScrollRequestId=te((function(){a.startScroll(),a.scroll(r),r*=.975,Math.abs(r)<1?null!==e._flingScrollRequestId&&(ee(e._flingScrollRequestId),e._flingScrollRequestId=null):s()}))};s()}}return!0;case Wt:case zt:i.dispatchEvent("mouseUpEvent",n)&&this._chart.updatePane(1)}}return!1},t.prototype.tapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget,o=!1;if(null!==n){var r=this._makeWidgetEvent(t,n),a=n.dispatchEvent("mouseClickEvent",r);if(n.getName()===Nt){var s=this._makeWidgetEvent(t,n),l=this._chart.getChartStore().getCrosshairStore();a?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,l.set(void 0,!0),o=!0):(this._touchCancelCrosshair||this._touchZoomed||(this._touchCoordinate={x:s.x,y:s.y},l.set({x:s.x,y:s.y,paneId:null==i?void 0:i.getId()},!0),o=!0),this._touchCancelCrosshair=!1)}(o||a)&&this._chart.updatePane(1)}return o},t.prototype.doubleTapEvent=function(t){return this.mouseDoubleClickEvent(t)},t.prototype.longTapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n&&n.getName()===Nt){var o=this._makeWidgetEvent(t,n);return this._touchCoordinate={x:o.x,y:o.y},this._chart.getChartStore().getCrosshairStore().set({x:o.x,y:o.y,paneId:null==i?void 0:i.getId()}),!0}return!1},t.prototype._findWidgetByEvent=function(t){var e,i,n=this._chart.getAllPanes(),o=t.x,r=t.y,a=null;try{for(var s=M(n),l=s.next();!l.done;l=s.next()){var c=k(l.value,2)[1],u=c.getBounding();if(o>=u.left&&o<=u.left+u.width&&r>=u.top&&r<=u.top+u.height){a=c;break}}}catch(t){e={error:t}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(e)throw e.error}}null===a&&(a=this._chart.getPaneById(Ut));var h=null;if(null!==a){var d=a.getSeparatorWidget();if(null!==d){var p=d.getBounding();o>=p.left&&o<=p.left+p.width&&r>=p.top&&r<=p.top+7&&(h=d)}if(null===h){var v=a.getMainWidget(),g=v.getBounding();o>=g.left&&o<=g.left+g.width&&r>=g.top&&r<=g.top+g.height&&(h=v)}if(null===h){var f=a.getYAxisWidget();if(null!==f){var m=f.getBounding();o>=m.left&&o<=m.left+m.width&&r>=m.top&&r<=m.top+m.height&&(h=f)}}}return{pane:a,widget:h}},t.prototype._makeWidgetEvent=function(t,e){var i,n,o,r=null!==(i=null==e?void 0:e.getBounding())&&void 0!==i?i:null;return E(E({},t),{x:t.x-(null!==(n=null==r?void 0:r.left)&&void 0!==n?n:0),y:t.y-(null!==(o=null==r?void 0:r.top)&&void 0!==o?o:0)})},t.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},t}();t.DomPosition=void 0,(ai=t.DomPosition||(t.DomPosition={})).Root="root",ai.Main="main",ai.YAxis="yAxis";var ci=function(){function e(t,e){this._panes=new Map,this._initContainer(t),this._chartEvent=new li(this._chartContainer,this),this._chartStore=new Qt(this,e),this._xAxisPane=new ni(this._chartContainer,this,Ut),this._panes.set(jt,new $e(this._chartContainer,this,jt)),this.adjustPaneViewport(!0,!0,!0)}return e.prototype._initContainer=function(t){this._container=t,this._chartContainer=O("div",{position:"relative",width:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)},e.prototype._measurePaneHeight=function(){var t,e=this._container.offsetHeight,i=this._xAxisPane.getAxisComponent().getAutoSize(),n=e-i;n<0&&(n=0);var o=0;this._panes.forEach((function(t){if(t.getId()!==jt){var e=t.getBounding().height,i=t.getOptions().minHeight;e<i&&(e=i),o+e>n?(o=n,e=Math.max(n-o,0)):o+=e,t.setBounding({height:e})}}));var r=n-o;null===(t=this._panes.get(jt))||void 0===t||t.setBounding({height:r});var a=0;this._panes.forEach((function(t){t.setBounding({top:a}),a+=t.getBounding().height})),this._xAxisPane.setBounding({height:i,top:a})},e.prototype._measurePaneWidth=function(){var e=this._chartStore.getStyles().yAxis,i=e.position===t.YAxisPosition.Left,n=!e.inside,o=this._container.offsetWidth,r=0,a=Number.MIN_SAFE_INTEGER,s=0,l=0;this._panes.forEach((function(t){a=Math.max(a,t.getAxisComponent().getAutoSize())})),a>o&&(a=o),n?(r=o-a,i?(s=0,l=a):(s=o-a,l=0)):(r=o,l=0,s=i?0:o-a),this._chartStore.getTimeScaleStore().setTotalBarSpace(r);var c={width:o},u={width:r,left:l},h={width:a,left:s};this._panes.forEach((function(t){t.setBounding(c,u,h)})),this._xAxisPane.setBounding(c,u,h)},e.prototype._setPaneOptions=function(t,e){var i,n,o=this._panes.get(null!==(i=null==t?void 0:t.id)&&void 0!==i?i:""),r=!1;if(void 0!==o){var a=e;if(t.id!==jt&&void 0!==t.height&&t.height>0){var s=Math.max(null!==(n=t.minHeight)&&void 0!==n?n:o.getOptions().minHeight,0),l=Math.max(s,t.height);o.setBounding({height:l}),a=!0,r=!0}o.setOptions(t),a&&this.adjustPaneViewport(r,!0,!0,!0,!0)}},e.prototype.getContainer=function(){return this._container},e.prototype.getChartStore=function(){return this._chartStore},e.prototype.getAllPanes=function(){return this._panes},e.prototype.adjustPaneViewport=function(t,e,i,n,o){t&&this._measurePaneHeight();var r=e,a=null!=o&&o;(null!=n&&n||a)&&this._panes.forEach((function(t){var e=t.getAxisComponent().buildTicks(a);r||(r=e)})),r&&this._measurePaneWidth(),null!=i&&i&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4))},e.prototype.updatePane=function(t,e){var i;void 0!==e?null===(i=this.getPaneById(e))||void 0===i||i.update(t):(this._xAxisPane.update(t),this._panes.forEach((function(e){e.update(t)})))},e.prototype.getPaneById=function(t){var e;return t===Ut?this._xAxisPane:null!==(e=this._panes.get(t))&&void 0!==e?e:null},e.prototype.crosshairChange=function(e){var i=this,n=this._chartStore.getActionStore();if(n.has(t.ActionType.OnCrosshairChange)){var o={};this._panes.forEach((function(t,n){var r={};i._chartStore.getIndicatorStore().getInstances(n).forEach((function(t){var i,n=t.result;r[t.name]=n[null!==(i=e.dataIndex)&&void 0!==i?i:n.length-1]})),o[n]=r})),void 0!==e.paneId&&n.execute(t.ActionType.OnCrosshairChange,E(E({},e),{indicatorData:o}))}},e.prototype.getDom=function(e,i){var n,o;if(void 0===e)return this._chartContainer;var r=this.getPaneById(e);if(null!==r)switch(null!=i?i:t.DomPosition.Root){case t.DomPosition.Root:return r.getContainer();case t.DomPosition.Main:return r.getMainWidget().getContainer();case t.DomPosition.YAxis:return null!==(o=null===(n=r.getYAxisWidget())||void 0===n?void 0:n.getContainer())&&void 0!==o?o:null}return null},e.prototype.getSize=function(e,i){var n,o;if(void 0===e)return{width:this._chartContainer.offsetWidth,height:this._chartContainer.offsetHeight,left:0,top:0,right:0,bottom:0};var r=this.getPaneById(e);if(null!==r)switch(null!=i?i:t.DomPosition.Root){case t.DomPosition.Root:return r.getBounding();case t.DomPosition.Main:return r.getMainWidget().getBounding();case t.DomPosition.YAxis:return null!==(o=null===(n=r.getYAxisWidget())||void 0===n?void 0:n.getBounding())&&void 0!==o?o:null}return null},e.prototype.setStyles=function(t){var e,i,n;this._chartStore.setOptions({styles:t}),void 0!==(null===(e=null==(n=l(t)?Jt(t):t)?void 0:n.yAxis)||void 0===e?void 0:e.type)&&(null===(i=this.getPaneById(jt))||void 0===i||i.getAxisComponent().setAutoCalcTickFlag(!0)),this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.getStyles=function(){return this._chartStore.getStyles()},e.prototype.setLocale=function(t){this._chartStore.setOptions({locale:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.getLocale=function(){return this._chartStore.getLocale()},e.prototype.setCustomApi=function(t){this._chartStore.setOptions({customApi:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.setPriceVolumePrecision=function(t,e){this._chartStore.setPrecision({price:t,volume:e})},e.prototype.getPriceVolumePrecision=function(){return this._chartStore.getPrecision()},e.prototype.setTimezone=function(t){this._chartStore.setOptions({timezone:t}),this._xAxisPane.getAxisComponent().buildTicks(!0),this._xAxisPane.update(3)},e.prototype.getTimezone=function(){return this._chartStore.getTimeScaleStore().getTimezone()},e.prototype.setOffsetRightDistance=function(t){this._chartStore.getTimeScaleStore().setOffsetRightDistance(t,!0)},e.prototype.setLeftMinVisibleBarCount=function(t){t>0&&this._chartStore.getTimeScaleStore().setLeftMinVisibleBarCount(Math.ceil(t))},e.prototype.setRightMinVisibleBarCount=function(t){t>0&&this._chartStore.getTimeScaleStore().setRightMinVisibleBarCount(Math.ceil(t))},e.prototype.setBarSpace=function(t){this._chartStore.getTimeScaleStore().setBarSpace(t)},e.prototype.getBarSpace=function(){return this._chartStore.getTimeScaleStore().getBarSpace().bar},e.prototype.getVisibleRange=function(){return this._chartStore.getTimeScaleStore().getVisibleRange()},e.prototype.clearData=function(){this._chartStore.clearDataList()},e.prototype.getDataList=function(){return this._chartStore.getDataList()},e.prototype.applyNewData=function(t,e){this._chartStore.clearDataList(),this.applyMoreData(t,e)},e.prototype.applyMoreData=function(t,e){var i=this;this._chartStore.addData(t,0,e),t.length>0&&this._chartStore.getIndicatorStore().calcInstance().then((function(t){i.adjustPaneViewport(!1,!0,!0,!0)})).catch((function(t){}))},e.prototype.updateData=function(t){var e=this,i=this._chartStore.getDataList(),n=i.length,o=t.timestamp,r=x(i[n-1],"timestamp",0);if(o>=r){var a=n;o===r&&(a=n-1),this._chartStore.addData(t,a),this._chartStore.getIndicatorStore().calcInstance().then((function(t){e.adjustPaneViewport(!1,!0,!0,!0)})).catch((function(t){}))}},e.prototype.loadMore=function(t){this._chartStore.getTimeScaleStore().setLoadMoreCallback(t)},e.prototype.createIndicator=function(t,e,i,n){var o,r,a,s=this,c=l(t)?{name:t}:t;if(null===mt(c.name))return null;if(void 0!==(null==i?void 0:i.id)&&this._panes.has(i.id))a=i.id,this._chartStore.getIndicatorStore().addInstance(c,a,null!=e&&e).then((function(t){var e,n;s._setPaneOptions(i,null!==(n=null===(e=s._panes.get(a))||void 0===e?void 0:e.getAxisComponent().buildTicks(!0))&&void 0!==n&&n)})).catch((function(t){}));else{a=null!==(o=null==i?void 0:i.id)&&void 0!==o?o:B(Gt);var u=Array.from(this._panes.values()).pop(),h=new Ke(this._chartContainer,this,a,u);u.setBottomPane(h);var d=null!==(r=null==i?void 0:i.height)&&void 0!==r?r:100;h.setBounding({height:d}),null!=i&&h.setOptions(i),this._panes.set(a,h),this._chartStore.getIndicatorStore().addInstance(c,a,null!=e&&e).finally((function(){s.adjustPaneViewport(!0,!0,!0,!0,!0),null==n||n()}))}return a},e.prototype.overrideIndicator=function(t,e,i){var n=this;this._chartStore.getIndicatorStore().override(t,null!=e?e:null).then((function(t){var e=k(t,2),o=e[0],r=e[1];(o||r)&&(n.adjustPaneViewport(!1,r,!0,r),null==i||i())})).catch((function(){}))},e.prototype.getIndicatorByPaneId=function(t,e){return this._chartStore.getIndicatorStore().getInstanceByPaneId(t,e)},e.prototype.removeIndicator=function(t,e){var i=this._chartStore.getIndicatorStore();if(i.removeInstance(t,e)){var n=!1;if(t!==jt&&!i.hasInstances(t)){var o=this._panes.get(t);if(void 0!==o){n=!0;var r=o.getTopPane(),a=o.getBottomPane();null==a||a.setTopPane(r),null==r||r.setBottomPane(a),null==o||o.destroy(),this._panes.delete(t)}}this.adjustPaneViewport(n,!0,!0,!0,!0)}},e.prototype.createOverlay=function(t,e){var i=l(t)?{name:t}:t;if(null===Bt(i.name))return null;var n=!0;return void 0!==e&&null!==this.getPaneById(e)||(e=jt,n=!1),this._chartStore.getOverlayStore().addInstance(i,e,n)},e.prototype.getOverlayById=function(t){return this._chartStore.getOverlayStore().getInstanceById(t)},e.prototype.overrideOverlay=function(t){this._chartStore.getOverlayStore().override(t)},e.prototype.removeOverlay=function(t){var e;void 0!==t&&(e=l(t)?{id:t}:t),this._chartStore.getOverlayStore().removeInstance(e)},e.prototype.setPaneOptions=function(t){this._setPaneOptions(t,!1)},e.prototype.setZoomEnabled=function(t){this._chartStore.getTimeScaleStore().setZoomEnabled(t)},e.prototype.isZoomEnabled=function(){return this._chartStore.getTimeScaleStore().getZoomEnabled()},e.prototype.setScrollEnabled=function(t){this._chartStore.getTimeScaleStore().setScrollEnabled(t)},e.prototype.isScrollEnabled=function(){return this._chartStore.getTimeScaleStore().getScrollEnabled()},e.prototype.scrollByDistance=function(t,e){var i=void 0===e||e<0?0:e,n=this._chartStore.getTimeScaleStore();if(i>0){n.startScroll();var o=(new Date).getTime(),r=function(){var e=((new Date).getTime()-o)/i,a=e>=1,s=a?t:t*e;n.scroll(s),a||requestAnimationFrame(r)};r()}else n.startScroll(),n.scroll(t)},e.prototype.scrollToRealTime=function(t){var e=this._chartStore.getTimeScaleStore(),i=e.getBarSpace().bar,n=(e.getOffsetRightBarCount()-e.getOffsetRightDistance()/i)*i;this.scrollByDistance(n,t)},e.prototype.scrollToDataIndex=function(t,e){var i=this._chartStore.getTimeScaleStore(),n=(i.getOffsetRightBarCount()+(this.getDataList().length-1-t))*i.getBarSpace().bar;this.scrollByDistance(n,e)},e.prototype.scrollToTimestamp=function(t,e){var i=z(this.getDataList(),"timestamp",t);this.scrollToDataIndex(i,e)},e.prototype.zoomAtCoordinate=function(t,e,i){var n=void 0===i||i<0?0:i,o=this._chartStore.getTimeScaleStore();if(n>0){var r=o.getBarSpace().bar,a=r*t-r,s=(new Date).getTime(),l=function(){var t=((new Date).getTime()-s)/n,i=t>=1,c=i?a:a*t;o.zoom(c/r,e),i||requestAnimationFrame(l)};l()}else o.zoom(t,e)},e.prototype.zoomAtDataIndex=function(t,e,i){var n=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:n,y:0},i)},e.prototype.zoomAtTimestamp=function(t,e,i){var n=z(this.getDataList(),"timestamp",e);this.zoomAtDataIndex(t,n,i)},e.prototype.convertToPixel=function(t,e){var i,o=e.paneId,r=void 0===o?jt:o,a=e.absolute,s=void 0!==a&&a,l=[];if(r!==Ut){var c=this.getPaneById(r);if(null!==c){var u=this._chartStore.getTimeScaleStore(),h=c.getBounding(),d=(new Array).concat(t),p=this._xAxisPane.getAxisComponent(),v=c.getAxisComponent();l=d.map((function(t){var e={},i=t.dataIndex;if(void 0!==t.timestamp&&(i=u.timestampToDataIndex(t.timestamp)),void 0!==i&&(e.x=null==p?void 0:p.convertToPixel(i)),void 0!==t.value){var n=null==v?void 0:v.convertToPixel(t.value);e.y=s?h.top+n:n}return e}))}}return n(t)?l:null!==(i=l[0])&&void 0!==i?i:{}},e.prototype.convertFromPixel=function(t,e){var i,o=e.paneId,r=void 0===o?jt:o,a=e.absolute,s=void 0!==a&&a,l=[];if(r!==Ut){var c=this.getPaneById(r);if(null!==c){var u=this._chartStore.getTimeScaleStore(),h=c.getBounding(),d=(new Array).concat(t),p=this._xAxisPane.getAxisComponent(),v=c.getAxisComponent();l=d.map((function(t){var e,i={};if(void 0!==t.x){var n=p.convertFromPixel(t.x);i.dataIndex=n,i.timestamp=null!==(e=u.dataIndexToTimestamp(n))&&void 0!==e?e:void 0}if(void 0!==t.y){var o=s?t.y-h.top:t.y;i.value=v.convertFromPixel(o)}return i}))}}return n(t)?l:null!==(i=l[0])&&void 0!==i?i:{}},e.prototype.subscribeAction=function(t,e){this._chartStore.getActionStore().subscribe(t,e)},e.prototype.unsubscribeAction=function(t,e){this._chartStore.getActionStore().unsubscribe(t,e)},e.prototype.getConvertPictureUrl=function(t,e,i){var n=this._chartContainer.offsetWidth,o=this._chartContainer.offsetHeight,r=O("canvas",{width:"".concat(n,"px"),height:"".concat(o,"px"),boxSizing:"border-box"}),a=r.getContext("2d"),s=V(r);r.width=n*s,r.height=o*s,a.scale(s,s),a.fillStyle=null!=i?i:"#FFFFFF",a.fillRect(0,0,n,o);var l=null!=t&&t;this._panes.forEach((function(t){var e=t.getBounding();a.drawImage(t.getImage(l),0,e.top,n,e.height)}));var c=this._xAxisPane.getBounding();return a.drawImage(this._xAxisPane.getImage(l),0,c.top,n,c.height),r.toDataURL("image/".concat(null!=e?e:"jpeg"))},e.prototype.resize=function(){this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.destroy=function(){this._chartEvent.destroy(),this._panes.forEach((function(t){t.destroy()})),this._panes.clear(),this._xAxisPane.destroy(),this._container.removeChild(this._chartContainer)},e}(),ui={},hi=1;var di={clone:i,merge:e,isString:l,isNumber:a,isValid:s,isObject:r,isArray:n,isFunction:o,isBoolean:function(t){return"boolean"==typeof t},formatValue:x,formatPrecision:C,formatBigNumber:b,formatDate:S,getLinearSlopeIntercept:Pt,getLinearYFromSlopeIntercept:It,getLinearYFromCoordinates:Et,checkCoordinateOnArc:Se,checkCoordinateOnCircle:ae,checkCoordinateOnLine:Tt,checkCoordinateOnPolygon:ce,checkCoordinateOnRect:de,checkCoordinateOnText:fe,drawArc:Ce,drawCircle:se,drawLine:Dt,drawPolygon:ue,drawRect:pe,drawText:me,drawRectText:_e};t.dispose=function(t){var e,i;if(l(t)){var n=document.getElementById(t);i=null!==(e=null==n?void 0:n.getAttribute("chartId"))&&void 0!==e?e:null}else i=t instanceof ci?t.id:null!=t?t:t.chartId;null!==i&&(ui[i].destroy(),delete ui[i])},t.getFigureClass=function(t){var e;return null!==(e=we[t])&&void 0!==e?e:null},t.getSupportedFigures=function(){return Object.keys(we)},t.getSupportedIndicators=function(){return Object.keys(gt)},t.getSupportedLocales=function(){return Object.keys(Oe)},t.getSupportedOverlays=function(){return Object.keys(Rt)},t.init=function(t,e){var i,n;if(null===(n=l(t)?document.getElementById(t):t))return null;var o=ui[null!==(i=n.chartId)&&void 0!==i?i:""];if(void 0!==o)return o;var r="k_line_chart_".concat(hi++);return(o=new ci(n,e)).id=r,n.chartId=r,ui[r]=o,o},t.registerFigure=function(t){we[t.name]=re.extend(t)},t.registerIndicator=function(t){gt[t.name]=$.extend(t)},t.registerLocale=function(t,e){Oe[t]=E(E({},Oe[t]),e)},t.registerOverlay=function(t){Rt[t.name]=Ct.extend(t)},t.registerStyles=function(t,e){$t[t]=e},t.utils=di,t.version=function(){return"9.1.1"}}));